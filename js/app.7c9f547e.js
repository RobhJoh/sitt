(function(e){function t(t){for(var i,r,n=t[0],l=t[1],c=t[2],m=0,h=[];m<n.length;m++)r=n[m],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&h.push(a[r][0]),a[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);d&&d(t);while(h.length)h.shift()();return o.push.apply(o,c||[]),s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],i=!0,n=1;n<s.length;n++){var l=s[n];0!==a[l]&&(i=!1)}i&&(o.splice(t--,1),e=r(r.s=s[0]))}return e}var i={},a={app:0},o=[];function r(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=i,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(s,i,function(t){return e[t]}.bind(null,i));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/sitt/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=t,n=n.slice();for(var c=0;c<n.length;c++)t(n[c]);var d=l;o.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"00c0":function(e){e.exports=JSON.parse('[{"id":"tb","name":"Trouble Brewing","author":"The Pandemonium Institute","description":"","level":"Beginner","roles":[],"isOfficial":true}]')},"0265":function(e,t,s){e.exports=s.p+"img/good.8ed2fd1e.svg"},"046f":function(e,t,s){e.exports=s.p+"img/spy.e6b841ef.svg"},"0548":function(e,t,s){"use strict";s("d7b3")},"05a5":function(e,t,s){"use strict";s("703f")},"076f":function(e,t,s){e.exports=s.p+"img/cupbearer.48caf865.svg"},"0a61":function(e,t,s){"use strict";s("1b58")},"0aaa":function(e,t,s){e.exports=s.p+"img/tb.bd1439f2.png"},"0ff5":function(e,t,s){e.exports=s.p+"img/duke.d4a3e99e.svg"},"11df":function(e,t,s){e.exports=s.p+"img/mute.bbbceed4.svg"},"14d9":function(e,t,s){e.exports=s.p+"img/minion.ea296df2.svg"},1557:function(e,t,s){"use strict";s("c859")},1821:function(e,t,s){},"1b58":function(e,t,s){},"246c":function(e,t,s){},"25ee":function(e,t,s){e.exports=s.p+"img/lordsrepresentative.34f2ba9e.svg"},"26c8":function(e,t,s){e.exports=s.p+"img/apothecary.55a0676a.svg"},2776:function(e,t,s){},"284f":function(e,t,s){"use strict";s("69e2")},"28bf":function(e,t,s){e.exports=s.p+"img/bmr-minion.6559191b.png"},"2fd0":function(e,t,s){e.exports=s.p+"img/snv.288a42ad.png"},3425:function(e,t,s){"use strict";s("246c")},"34af":function(e,t,s){e.exports=s.p+"img/outsider.2e793a41.svg"},"3a48":function(e,t,s){e.exports=s.p+"img/treasurer.00d9293f.svg"},"3d0b":function(e,t,s){e.exports=s.p+"img/custom.887752ad.svg"},"3d41":function(e,t,s){"use strict";s("7b7c")},"441d":function(e,t,s){e.exports=s.p+"img/custom.5334aaeb.png"},"44b5":function(e,t,s){e.exports=s.p+"img/duel.4aef5c74.svg"},"451a":function(e,t,s){e.exports=s.p+"img/snv-minion.60768802.png"},"47c2":function(e,t,s){},"4aa7":function(e,t,s){},"4dd9":function(e,t,s){e.exports=s.p+"img/snv-outsider.5b5cae7f.png"},5132:function(e,t,s){"use strict";s("b13a")},"535c":function(e,t,s){},5421:function(e,t,s){},5674:function(e,t,s){e.exports=s.p+"img/vigilante.e11fa4f0.svg"},"56b6":function(e,t,s){e.exports=s.p+"img/evil.c3006c5c.svg"},"56d7":function(e,t,s){"use strict";s.r(t);var i=s("2b0e"),a=function(){var e=this,t=e._self._c;return t("div",{class:{night:e.grimoire.isNight,static:e.grimoire.isStatic},style:{backgroundImage:e.grimoire.background?`url('${e.grimoire.background}')`:""},attrs:{id:"app",tabindex:"-1"},on:{keyup:e.keyup}},[e.grimoire.background&&e.grimoire.background.match(/\.(mp4|webm)$/i)?t("video",{attrs:{id:"background",src:e.grimoire.background,autoplay:"",loop:""}}):e._e(),t("div",{staticClass:"backdrop"}),t("transition",{attrs:{name:"blur"}},[e.players.length?e._e():t("Intro"),e.players.length&&!e.session.nomination?t("TownInfo"):e._e(),e.session.nomination?t("Vote"):e._e()],1),t("TownSquare"),t("Menu",{ref:"menu"}),t("EditionModal"),t("FabledModal"),t("RolesModal"),t("ReferenceModal"),t("NightOrderModal"),t("VoteHistoryModal"),t("GameStateModal"),t("Gradients"),t("span",{attrs:{id:"version"}},[e._v("v"+e._s(e.version))])],1)},o=[],r=s("2f62"),n=s("9224"),l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"square",class:{public:e.grimoire.isPublic,spectator:e.session.isSpectator,vote:e.session.nomination},attrs:{id:"townsquare"}},[t("transition",{attrs:{name:"blur"}},[e.session.isPlayFanfare?t("span",{attrs:{id:"fanfare-icon"}},[t("font-awesome-icon",{attrs:{icon:"crown"}})],1):e._e()]),t("ul",{staticClass:"circle",class:["size-"+e.players.length]},e._l(e.players,(function(s,i){return t("Player",{key:i,class:{from:Math.max(e.swap,e.move,e.nominate)===i,swap:e.swap>-1,move:e.move>-1,nominate:e.nominate>-1},attrs:{player:s},on:{trigger:function(t){return e.handleTrigger(i,t)}}})})),1),e.players.length?t("div",{ref:"bluffs",staticClass:"bluffs",class:{closed:!e.isBluffsOpen}},[t("h3",[e.session.isSpectator?t("span",[e._v("Andra karaktärer")]):t("span",[e._v("Troninkräktarens bluffar")]),t("font-awesome-icon",{attrs:{icon:"times-circle"},on:{click:function(t){return t.stopPropagation(),e.toggleBluffs.apply(null,arguments)}}}),t("font-awesome-icon",{attrs:{icon:"plus-circle"},on:{click:function(t){return t.stopPropagation(),e.toggleBluffs.apply(null,arguments)}}})],1),t("ul",e._l(e.bluffSize,(function(s){return t("li",{key:s,on:{click:function(t){return e.openRoleModal(-1*s)}}},[t("Token",{attrs:{role:e.bluffs[s-1]}})],1)})),0)]):e._e(),e.fabled.length?t("div",{staticClass:"fabled",class:{closed:!e.isFabledOpen}},[t("h3",[t("span",[e._v("Legender")]),t("font-awesome-icon",{attrs:{icon:"times-circle"},on:{click:function(t){return t.stopPropagation(),e.toggleFabled.apply(null,arguments)}}}),t("font-awesome-icon",{attrs:{icon:"plus-circle"},on:{click:function(t){return t.stopPropagation(),e.toggleFabled.apply(null,arguments)}}})],1),t("ul",e._l(e.fabled,(function(s,i){return t("li",{key:i,on:{click:function(t){return e.removeFabled(i)}}},[e.nightOrder.get(s).first&&e.grimoire.isNightOrder?t("div",{staticClass:"night-order first"},[t("em",[e._v(e._s(e.nightOrder.get(s).first)+".")]),s.firstNightReminder?t("span",[e._v(e._s(s.firstNightReminder))]):e._e()]):e._e(),e.nightOrder.get(s).other&&e.grimoire.isNightOrder?t("div",{staticClass:"night-order other"},[t("em",[e._v(e._s(e.nightOrder.get(s).other)+".")]),s.otherNightReminder?t("span",[e._v(e._s(s.otherNightReminder))]):e._e()]):e._e(),t("Token",{attrs:{role:s}})],1)})),0)]):e._e(),t("ReminderModal",{attrs:{"player-index":e.selectedPlayer}}),t("RoleModal",{attrs:{"player-index":e.selectedPlayer}})],1)},c=[],d=function(){var e=this,t=e._self._c;return t("li",{style:e.zoom},[t("div",{ref:"player",staticClass:"player",class:[{dead:e.player.isDead,marked:e.session.markedPlayer===e.index,"no-vote":e.player.isVoteless,you:e.session.sessionId&&e.player.id&&e.player.id===e.session.playerId,"vote-yes":e.session.votes[e.index],"vote-lock":e.voteLocked},e.player.role.team]},[t("div",{staticClass:"shroud",on:{click:function(t){return e.toggleStatus()}}}),t("div",{staticClass:"life",on:{click:function(t){return e.toggleStatus()}}}),e.nightOrder.get(e.player).first&&e.grimoire.isNightOrder?t("div",{staticClass:"night-order first"},[t("em",[e._v(e._s(e.nightOrder.get(e.player).first)+".")]),e.player.role.firstNightReminder?t("span",[e._v(e._s(e.player.role.firstNightReminder))]):e._e()]):e._e(),e.nightOrder.get(e.player).other&&e.grimoire.isNightOrder?t("div",{staticClass:"night-order other"},[t("em",[e._v(e._s(e.nightOrder.get(e.player).other)+".")]),e.player.role.otherNightReminder?t("span",[e._v(e._s(e.player.role.otherNightReminder))]):e._e()]):e._e(),t("Token",{attrs:{role:e.player.role},on:{"set-role":function(t){return e.$emit("trigger",["openRoleModal"])}}}),t("div",{staticClass:"overlay"},[t("font-awesome-icon",{staticClass:"vote",attrs:{icon:"hand-paper",title:"Hand UP"},on:{click:function(t){return e.vote()}}}),t("font-awesome-icon",{staticClass:"vote",attrs:{icon:"times",title:"Hand DOWN"},on:{click:function(t){return e.vote()}}}),t("font-awesome-icon",{staticClass:"cancel",attrs:{icon:"times-circle",title:"Cancel"},on:{click:function(t){return e.cancel()}}}),t("font-awesome-icon",{staticClass:"swap",attrs:{icon:"exchange-alt",title:"Swap seats with this player"},on:{click:function(t){return e.swapPlayer(e.player)}}}),t("font-awesome-icon",{staticClass:"move",attrs:{icon:"redo-alt",title:"Move player to this seat"},on:{click:function(t){return e.movePlayer(e.player)}}}),t("font-awesome-icon",{staticClass:"nominate",attrs:{icon:"hand-point-right",title:"Nominate this player"},on:{click:function(t){return e.nominatePlayer(e.player)}}})],1),e.player.id&&e.session.sessionId?t("font-awesome-icon",{staticClass:"seat",class:{highlight:e.session.isRolesDistributed},attrs:{icon:"chair"}}):e._e(),e.player.isDead&&!e.player.isVoteless?t("font-awesome-icon",{staticClass:"has-vote",attrs:{icon:"vote-yea",title:"Ghost vote"},on:{click:function(t){return e.updatePlayer("isVoteless",!0)}}}):e._e(),t("div",{staticClass:"marked"},[t("font-awesome-icon",{attrs:{icon:"times"}})],1),t("div",{staticClass:"name",class:{active:e.isMenuOpen},on:{click:function(t){e.isMenuOpen=!e.isMenuOpen}}},[t("span",[e._v(e._s(e.player.name))]),e.player.pronouns?t("font-awesome-icon",{attrs:{icon:"venus-mars"}}):e._e(),e.player.pronouns?t("div",{staticClass:"pronouns"},[t("span",[e._v(e._s(e.player.pronouns))])]):e._e()],1),t("transition",{attrs:{name:"fold"}},[e.isMenuOpen?t("ul",{staticClass:"menu"},[e.session.isSpectator?e._e():[t("li",{on:{click:e.changeName}},[t("font-awesome-icon",{attrs:{icon:"user-edit"}}),e._v("Ändra namn ")],1),t("li",{class:{disabled:e.session.lockedVote},on:{click:function(t){return e.movePlayer()}}},[t("font-awesome-icon",{attrs:{icon:"redo-alt"}}),e._v(" Flytta spelare ")],1),t("li",{class:{disabled:e.session.lockedVote},on:{click:function(t){return e.swapPlayer()}}},[t("font-awesome-icon",{attrs:{icon:"exchange-alt"}}),e._v(" Byt plats ")],1),t("li",{class:{disabled:e.session.lockedVote},on:{click:e.removePlayer}},[t("font-awesome-icon",{attrs:{icon:"times-circle"}}),e._v(" Ta bort ")],1),e.player.id&&e.session.sessionId?t("li",{on:{click:function(t){return e.updatePlayer("id","",!0)}}},[t("font-awesome-icon",{attrs:{icon:"chair"}}),e._v(" Tom plats ")],1):e._e(),e.session.nomination?e._e():[t("li",{on:{click:function(t){return e.nominatePlayer()}}},[t("font-awesome-icon",{attrs:{icon:"hand-point-right"}}),e._v(" Nominering ")],1)]],e.session.isSpectator?t("li",{class:{disabled:e.player.id&&e.player.id!==e.session.playerId},on:{click:e.claimSeat}},[t("font-awesome-icon",{attrs:{icon:"chair"}}),e.player.id?e.player.id===e.session.playerId?[e._v(" Lämna plats ")]:[e._v(" Plats upptagen")]:[e._v(" Ta plats ")]],2):e._e()],2):e._e()])],1),e.player.reminders?e._l(e.player.reminders,(function(i){return t("div",{key:i.role+" "+i.name,staticClass:"reminder",class:[i.role],on:{click:function(t){return e.removeReminder(i)}}},[t("span",{staticClass:"icon",style:{backgroundImage:`url(${i.image&&e.grimoire.isImageOptIn?i.image:s("6f32")("./"+(i.imageAlt||i.role)+".svg")})`}}),t("span",{staticClass:"text"},[e._v(e._s(i.name))])])})):e._e(),t("div",{staticClass:"reminder add",on:{click:function(t){return e.$emit("trigger",["openReminderModal"])}}},[t("span",{staticClass:"icon"})]),t("div",{staticClass:"reminderHoverTarget"})],2)},m=[],h=function(){var e=this,t=e._self._c;return t("div",{staticClass:"token",class:[e.role.id],on:{click:e.setRole}},[e.role.id?t("span",{staticClass:"icon",style:{backgroundImage:`url(${e.role.image&&e.grimoire.isImageOptIn?e.role.image:s("6f32")("./"+(e.role.imageAlt||e.role.id)+".svg")})`}}):e._e(),e.role.firstNight||e.role.firstNightReminder?t("span",{staticClass:"leaf-left"}):e._e(),e.role.otherNight||e.role.otherNightReminder?t("span",{staticClass:"leaf-right"}):e._e(),e.reminderLeaves?t("span",{class:["leaf-top"+e.reminderLeaves]}):e._e(),e.role.setup?t("span",{staticClass:"leaf-orange"}):e._e(),t("svg",{staticClass:"name",attrs:{viewBox:"0 0 150 150"}},[t("path",{attrs:{d:"M 13 75 C 13 160, 138 160, 138 75",id:"curve",fill:"transparent"}}),t("text",{staticClass:"label mozilla",attrs:{width:"150",x:"66.6%","text-anchor":"middle","font-size":e._f("nameToFontSize")(e.role.name)}},[t("textPath",{attrs:{"xlink:href":"#curve"}},[e._v(" "+e._s(e.role.name)+" ")])])]),t("div",{staticClass:"edition",class:["edition-"+e.role.edition,e.role.team]}),e.role.ability?t("div",{staticClass:"ability"},[e._v(" "+e._s(e.role.ability)+" ")]):e._e()])},p=[],g={name:"Token",props:{role:{type:Object,default:()=>({})}},computed:{reminderLeaves:function(){return(this.role.reminders||[]).length+(this.role.remindersGlobal||[]).length},...Object(r["d"])(["grimoire"])},data(){return{}},filters:{nameToFontSize:e=>e&&e.length>10?"90%":"110%"},methods:{setRole(){this.$emit("set-role")}}},u=g,f=(s("f22b"),s("2877")),v=Object(f["a"])(u,h,p,!1,null,"23340545",null),y=v.exports,b={components:{Token:y},props:{player:{type:Object,required:!0}},computed:{...Object(r["d"])("players",["players"]),...Object(r["d"])(["grimoire","session"]),...Object(r["b"])({nightOrder:"players/nightOrder"}),index:function(){return this.players.indexOf(this.player)},voteLocked:function(){const e=this.session,t=this.players.length;if(!e.nomination)return!1;const s=(this.index-1+t-e.nomination[1])%t;return s<e.lockedVote-1},zoom:function(){const e=window.innerWidth>window.innerHeight?"vh":"vw";return this.players.length<7?{width:18+this.grimoire.zoom+e}:this.players.length<=10?{width:16+this.grimoire.zoom+e}:this.players.length<=15?{width:14+this.grimoire.zoom+e}:{width:12+this.grimoire.zoom+e}}},data(){return{isMenuOpen:!1,isSwap:!1}},methods:{changePronouns(){if(this.session.isSpectator&&this.player.id!==this.session.playerId)return;const e=prompt("Player pronouns",this.player.pronouns);null!==e&&this.updatePlayer("pronouns",e,!0)},toggleStatus(){this.grimoire.isPublic?this.player.isDead?this.player.isVoteless?(this.updatePlayer("isVoteless",!1),this.updatePlayer("isDead",!1)):this.updatePlayer("isVoteless",!0):(this.updatePlayer("isDead",!0),this.player.isMarked&&this.updatePlayer("isMarked",!1)):(this.updatePlayer("isDead",!this.player.isDead),this.player.isMarked&&this.updatePlayer("isMarked",!1),this.player.isVoteless&&this.updatePlayer("isVoteless",!1))},changeName(){if(this.session.isSpectator)return;const e=prompt("Player name",this.player.name)||this.player.name;this.updatePlayer("name",e,!0)},removeReminder(e){const t=[...this.player.reminders];t.splice(this.player.reminders.indexOf(e),1),this.updatePlayer("reminders",t,!0)},updatePlayer(e,t,s=!1){this.session.isSpectator&&"reminders"!==e&&"pronouns"!==e||(this.$store.commit("players/update",{player:this.player,property:e,value:t}),s&&(this.isMenuOpen=!1))},removePlayer(){this.isMenuOpen=!1,this.$emit("trigger",["removePlayer"])},swapPlayer(e){this.isMenuOpen=!1,this.$emit("trigger",["swapPlayer",e])},movePlayer(e){this.isMenuOpen=!1,this.$emit("trigger",["movePlayer",e])},nominatePlayer(e){this.isMenuOpen=!1,this.$emit("trigger",["nominatePlayer",e])},cancel(){this.$emit("trigger",["cancel"])},claimSeat(){this.isMenuOpen=!1,this.$emit("trigger",["claimSeat"])},vote(){this.session.isSpectator||this.voteLocked&&this.$store.commit("session/voteSync",[this.index,!this.session.votes[this.index]])}}},k=b,_=(s("aecf"),Object(f["a"])(k,d,m,!1,null,null,null)),S=_.exports,w=function(){var e=this,t=e._self._c;return e.modals.reminder&&e.availableReminders.length&&e.players[e.playerIndex]?t("Modal",{on:{close:function(t){return e.toggleModal("reminder")}}},[t("h3",[e._v("Välj en påminnelsemarkör:")]),t("ul",{staticClass:"reminders"},e._l(e.availableReminders,(function(i){return t("li",{key:i.role+" "+i.name,staticClass:"reminder",class:[i.role],on:{click:function(t){return e.addReminder(i)}}},[t("span",{staticClass:"icon",style:{backgroundImage:`url(${i.image&&e.grimoire.isImageOptIn?i.image:s("6f32")("./"+(i.imageAlt||i.role)+".svg")})`}}),t("span",{staticClass:"text"},[e._v(e._s(i.name))])])})),0)]):e._e()},N=[],O=function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"modal-fade"}},[t("div",{staticClass:"modal-backdrop",on:{click:e.close}},[t("div",{staticClass:"modal",class:{maximized:e.isMaximized},attrs:{role:"dialog","aria-labelledby":"modalTitle","aria-describedby":"modalDescription"},on:{click:function(e){e.stopPropagation()}}},[t("div",{staticClass:"top-right-buttons"},[t("font-awesome-icon",{staticClass:"top-right-button",attrs:{icon:["fas",e.isMaximized?"window-minimize":"window-maximize"]},on:{click:function(t){e.isMaximized=!e.isMaximized}}}),t("font-awesome-icon",{staticClass:"top-right-button",attrs:{icon:"times-circle"},on:{click:e.close}})],1),t("div",{staticClass:"slot"},[e._t("default")],2)])])])},I=[],M={data:function(){return{isMaximized:!1}},methods:{close(){this.$emit("close")}}},C=M,R=(s("690b"),Object(f["a"])(C,O,I,!1,null,null,null)),x=R.exports;const P=({id:e,image:t,imageAlt:s})=>i=>({role:e,image:t,imageAlt:s,name:i});var j={components:{Modal:x},props:["playerIndex"],computed:{availableReminders(){let e=[];const{players:t,bluffs:s}=this.$store.state.players;return this.$store.state.roles.forEach(i=>{(t.some(e=>e.role.id===i.id)||s.some(e=>e.id===i.id))&&(e=[...e,...i.reminders.map(P(i))]),i.remindersGlobal&&i.remindersGlobal.length&&(e=[...e,...i.remindersGlobal.map(P(i))])}),this.$store.state.players.fabled.forEach(t=>{e=[...e,...t.reminders.map(P(t))]}),this.$store.state.otherTravelers.forEach(s=>{t.some(e=>e.role.id===s.id)&&(e=[...e,...s.reminders.map(P(s))])}),e.push({role:"good",name:"Lojal"}),e.push({role:"evil",name:"Inkräktare"}),e.push({role:"custom",name:"Egen anteckning"}),e},...Object(r["d"])(["modals","grimoire"]),...Object(r["d"])("players",["players"])},methods:{addReminder(e){const t=this.$store.state.players.players[this.playerIndex];let s;if("custom"===e.role){const e=prompt("Lägg till en egen påminnelse");if(!e)return;s=[...t.reminders,{role:"custom",name:e}]}else s=[...t.reminders,e];this.$store.commit("players/update",{player:t,property:"reminders",value:s}),this.$store.commit("toggleModal","reminder")},...Object(r["c"])(["toggleModal"])}},V=j,T=(s("1557"),Object(f["a"])(V,w,N,!1,null,"b846bb26",null)),$=T.exports,H=function(){var e=this,t=e._self._c;return e.modals.role&&e.availableRoles.length?t("Modal",{on:{close:e.close}},[t("h3",[e._v(" Choose a new character for "+e._s(e.playerIndex>=0&&e.players.length?e.players[e.playerIndex].name:"bluffing")+" ")]),"editionRoles"!==e.tab&&e.otherTravelers.size?e._e():t("ul",{staticClass:"tokens"},e._l(e.availableRoles,(function(s){return t("li",{key:s.id,class:[s.team],on:{click:function(t){return e.setRole(s)}}},[t("Token",{attrs:{role:s}})],1)})),0),"otherTravelers"===e.tab&&e.otherTravelers.size?t("ul",{staticClass:"tokens"},e._l(e.otherTravelers.values(),(function(s){return t("li",{key:s.id,class:[s.team],on:{click:function(t){return e.setRole(s)}}},[t("Token",{attrs:{role:s}})],1)})),0):e._e(),e.playerIndex>=0&&e.otherTravelers.size&&!e.session.isSpectator?t("div",{staticClass:"button-group"},[t("span",{staticClass:"button",class:{townsfolk:"editionRoles"===e.tab},on:{click:function(t){e.tab="editionRoles"}}},[e._v("Utgåvans roller")]),t("span",{staticClass:"button",class:{townsfolk:"otherTravelers"===e.tab},on:{click:function(t){e.tab="otherTravelers"}}},[e._v("Andra Gäster")])]):e._e()]):e._e()},F=[],D={components:{Token:y,Modal:x},props:["playerIndex"],computed:{availableRoles(){const e=[],t=this.$store.state.players.players;return this.$store.state.roles.forEach(s=>{(this.playerIndex>=0||this.playerIndex<0&&!t.some(e=>e.role.id===s.id))&&e.push(s)}),e.push({}),e},...Object(r["d"])(["modals","roles","session"]),...Object(r["d"])("players",["players"]),...Object(r["d"])(["otherTravelers"])},data(){return{tab:"editionRoles"}},methods:{setRole(e){if(this.playerIndex<0)this.$store.commit("players/setBluff",{index:-1*this.playerIndex-1,role:e});else{if(this.session.isSpectator&&"traveler"===e.team)return;const t=this.$store.state.players.players[this.playerIndex];this.$store.commit("players/update",{player:t,property:"role",value:e})}this.tab="editionRoles",this.$store.commit("toggleModal","role")},close(){this.tab="editionRoles",this.toggleModal("role")},...Object(r["c"])(["toggleModal"])}},E=D,L=(s("d5ff"),Object(f["a"])(E,H,F,!1,null,"13b21ee4",null)),G=L.exports,A={components:{Player:S,Token:y,RoleModal:G,ReminderModal:$},computed:{...Object(r["b"])({nightOrder:"players/nightOrder"}),...Object(r["d"])(["grimoire","roles","session"]),...Object(r["d"])("players",["players","bluffs","fabled"])},data(){return{selectedPlayer:0,bluffSize:3,swap:-1,move:-1,nominate:-1,isBluffsOpen:!0,isFabledOpen:!0}},methods:{toggleBluffs(){this.isBluffsOpen=!this.isBluffsOpen},toggleFabled(){this.isFabledOpen=!this.isFabledOpen},removeFabled(e){this.session.isSpectator||this.$store.commit("players/setFabled",{index:e})},handleTrigger(e,[t,s]){"function"===typeof this[t]&&this[t](e,s)},claimSeat(e){this.session.isSpectator&&(this.session.playerId===this.players[e].id?this.$store.commit("session/claimSeat",-1):this.$store.commit("session/claimSeat",e))},openReminderModal(e){this.selectedPlayer=e,this.$store.commit("toggleModal","reminder")},openRoleModal(e){const t=this.players[e];this.session.isSpectator&&t&&"traveler"===t.role.team||(this.selectedPlayer=e,this.$store.commit("toggleModal","role"))},removePlayer(e){if(!this.session.isSpectator&&!this.session.lockedVote&&confirm(`Vill du verkligen ta bort ${this.players[e].name}?`)){const{nomination:t}=this.session;t&&(t.includes(e)?this.$store.commit("session/nomination"):(t[0]>e||t[1]>e)&&this.$store.commit("session/setNomination",[t[0]>e?t[0]-1:t[0],t[1]>e?t[1]-1:t[1]])),this.$store.commit("players/remove",e)}},swapPlayer(e,t){if(!this.session.isSpectator&&!this.session.lockedVote)if(void 0===t)this.cancel(),this.swap=e;else{if(this.session.nomination){const e=this.players.indexOf(t),s=this.session.nomination.map(t=>t===this.swap?e:t===e?this.swap:t);this.session.nomination[0]===s[0]&&this.session.nomination[1]===s[1]||this.$store.commit("session/setNomination",s)}this.$store.commit("players/swap",[this.swap,this.players.indexOf(t)]),this.cancel()}},movePlayer(e,t){if(!this.session.isSpectator&&!this.session.lockedVote)if(void 0===t)this.cancel(),this.move=e;else{if(this.session.nomination){const e=this.players.indexOf(t),s=this.session.nomination.map(t=>t===this.move?e:t>this.move&&t<=e?t-1:t<this.move&&t>=e?t+1:t);this.session.nomination[0]===s[0]&&this.session.nomination[1]===s[1]||this.$store.commit("session/setNomination",s)}this.$store.commit("players/move",[this.move,this.players.indexOf(t)]),this.cancel()}},nominatePlayer(e,t){if(!this.session.isSpectator&&!this.session.lockedVote)if(void 0===t)this.cancel(),e!==this.nominate&&(this.nominate=e);else{const e=[this.nominate,this.players.indexOf(t)];this.$store.commit("session/nomination",{nomination:e}),this.cancel()}},cancel(){this.move=-1,this.swap=-1,this.nominate=-1}}},B=A,z=(s("fc54"),Object(f["a"])(B,l,c,!1,null,null,null)),J=z.exports,U=function(){var e=this,t=e._self._c;return t("ul",{staticClass:"info"},[t("li",{staticClass:"edition",class:["edition-"+e.edition.id],style:{backgroundImage:`url(${e.edition.logo&&e.grimoire.isImageOptIn?e.edition.logo:s("ce23")("./"+e.edition.id+".png")})`}}),e.players.length-e.teams.traveler<5?t("li",[e._v(" Lägg till fler spelare! ")]):e._e(),t("li",[e.edition.isOfficial?e._e():t("span",{staticClass:"meta"},[e._v(" "+e._s(e.edition.name)+" "+e._s(e.edition.author?"by "+e.edition.author:"")+" ")]),t("span",[e._v(" "+e._s(e.players.length)+" "),t("font-awesome-icon",{staticClass:"players",attrs:{icon:"users"}})],1),t("span",[e._v(" "+e._s(e.teams.alive)+" "),t("font-awesome-icon",{staticClass:"alive",attrs:{icon:"chess-rook"}})],1),t("span",[e._v(" "+e._s(e.teams.votes)+" "),t("font-awesome-icon",{staticClass:"votes",attrs:{icon:"vote-yea"}})],1)]),e.players.length-e.teams.traveler>=5?t("li",[t("span",[e._v(" "+e._s(e.teams.townsfolk)+" "),t("font-awesome-icon",{staticClass:"townsfolk",attrs:{icon:"user-friends"}})],1),t("span",[e._v(" "+e._s(e.teams.outsider)+" "),t("font-awesome-icon",{staticClass:"outsider",attrs:{icon:e.teams.outsider>1?"user-friends":"user"}})],1),t("span",[e._v(" "+e._s(e.teams.minion)+" "),t("font-awesome-icon",{staticClass:"minion",attrs:{icon:e.teams.minion>1?"user-friends":"user"}})],1),t("span",[e._v(" "+e._s(e.teams.demon)+" "),t("font-awesome-icon",{staticClass:"demon",attrs:{icon:e.teams.demon>1?"user-friends":"user"}})],1),e.teams.traveler?t("span",[e._v(" "+e._s(e.teams.traveler)+" "),t("font-awesome-icon",{staticClass:"traveler",attrs:{icon:e.teams.traveler>1?"user-friends":"user"}})],1):e._e(),e.grimoire.isNight?t("span",[e._v(" Nattfas "),t("font-awesome-icon",{attrs:{icon:["fas","cloud-moon"]}})],1):e._e()]):e._e()])},q=[],K=s("634a"),W={computed:{teams:function(){const{players:e}=this.$store.state.players,t=this.$store.getters["players/nonTravelers"],s=e.filter(e=>!0!==e.isDead).length;return{...K[t-5],traveler:e.length-t,alive:s,votes:s+e.filter(e=>!0===e.isDead&&!0!==e.isVoteless).length}},...Object(r["d"])(["edition","grimoire"]),...Object(r["d"])("players",["players"])}},Z=W,Q=(s("f0be"),Object(f["a"])(Z,U,q,!1,null,"117e5758",null)),Y=Q.exports,X=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"controls"}},[t("audio",{attrs:{id:"fanfare",src:s("7ff7"),preload:"auto"}}),e.session.isPlayFanfare?t("div",{staticClass:"fanfare"},[t("audio",{attrs:{autoplay:!e.grimoire.isMuted,src:s("7ff7"),muted:e.grimoire.isMuted}})]):e._e(),t("span",{directives:[{name:"show",rawName:"v-show",value:e.session.voteHistory.length&&e.session.sessionId,expression:"session.voteHistory.length && session.sessionId"}],staticClass:"nomlog-summary",attrs:{title:`${e.session.voteHistory.length} recent ${1==e.session.voteHistory.length?"nomination":"nominations"}`},on:{click:function(t){return e.toggleModal("voteHistory")}}},[t("font-awesome-icon",{attrs:{icon:"book-dead"}}),e._v(" "+e._s(e.session.voteHistory.length)+" ")],1),e.session.sessionId?t("span",{staticClass:"session",class:{spectator:e.session.isSpectator,reconnecting:e.session.isReconnecting},attrs:{title:`${e.session.playerCount} andra spelare i denna session${e.session.ping?" ("+e.session.ping+"ms latency)":""}`},on:{click:e.leaveSession}},[t("font-awesome-icon",{attrs:{icon:"broadcast-tower"}}),e._v(" "+e._s(e.session.playerCount)+" ")],1):e._e(),t("div",{staticClass:"menu",class:{open:e.grimoire.isMenuOpen}},[t("font-awesome-icon",{attrs:{icon:"cog"},on:{click:e.toggleMenu}}),t("ul",[t("li",{staticClass:"tabs",class:e.tab},[t("font-awesome-icon",{attrs:{icon:"book-open"},on:{click:function(t){e.tab="grimoire"}}}),t("font-awesome-icon",{attrs:{icon:"broadcast-tower"},on:{click:function(t){e.tab="session"}}}),e.session.isSpectator?e._e():t("font-awesome-icon",{attrs:{icon:"users"},on:{click:function(t){e.tab="players"}}}),t("font-awesome-icon",{attrs:{icon:"theater-masks"},on:{click:function(t){e.tab="characters"}}}),t("font-awesome-icon",{attrs:{icon:"question"},on:{click:function(t){e.tab="help"}}})],1),"grimoire"===e.tab?[t("li",{staticClass:"headline"},[e._v("Hemlig bok")]),e.players.length?t("li",{on:{click:e.toggleGrimoire}},[e.grimoire.isPublic?e._e():[e._v("Göm")],e.grimoire.isPublic?[e._v("Visa")]:e._e(),t("em",[e._v("[G]")])],2):e._e(),e.session.isSpectator?e._e():t("li",{on:{click:e.toggleNight}},[e.grimoire.isNight?e._e():[e._v("Byt till Natt")],e.grimoire.isNight?[e._v("Byt till Dag")]:e._e(),t("em",[e._v("[S]")])],2),e.players.length?t("li",{on:{click:e.toggleNightOrder}},[e._v(" Nattordning "),t("em",[t("font-awesome-icon",{attrs:{icon:["fas",e.grimoire.isNightOrder?"check-square":"square"]}})],1)]):e._e(),e.players.length?t("li",[e._v(" Zoom "),t("em",[t("font-awesome-icon",{attrs:{icon:"search-minus"},on:{click:function(t){return e.setZoom(e.grimoire.zoom-1)}}}),e._v(" "+e._s(Math.round(100+10*e.grimoire.zoom))+"% "),t("font-awesome-icon",{attrs:{icon:"search-plus"},on:{click:function(t){return e.setZoom(e.grimoire.zoom+1)}}})],1)]):e._e(),t("li",{on:{click:e.setBackground}},[e._v(" Bakgrundsbild "),t("em",[t("font-awesome-icon",{attrs:{icon:"image"}})],1)]),e.edition.isOfficial?e._e():t("li",{on:{click:e.imageOptIn}},[t("small",[e._v("Visa egna bilder")]),t("em",[t("font-awesome-icon",{attrs:{icon:["fas",e.grimoire.isImageOptIn?"check-square":"square"]}})],1)]),t("li",{on:{click:e.toggleStatic}},[e._v(" Inaktivera animationer "),t("em",[t("font-awesome-icon",{attrs:{icon:["fas",e.grimoire.isStatic?"check-square":"square"]}})],1)]),t("li",{on:{click:e.toggleMuted}},[e._v(" Stäng av ljud "),t("em",[t("font-awesome-icon",{attrs:{icon:["fas",e.grimoire.isMuted?"volume-mute":"volume-up"]}})],1)])]:e._e(),"session"===e.tab?[e.session.sessionId?t("li",{staticClass:"headline"},[e._v(" "+e._s(e.session.isSpectator?"Spelande":"Värdskap")+" ")]):t("li",{staticClass:"headline"},[e._v(" Live Session ")]),e.session.sessionId?[e.session.isSpectator?e._e():t("li",{on:{click:e.playFanfare}},[e._v(" Spela fanfar "),t("em",[t("font-awesome-icon",{attrs:{icon:"theater-masks"}})],1)]),e.session.ping?t("li",[e._v(" Fördröj till "+e._s(e.session.isSpectator?"värden":"spelarna")+" "),t("em",[e._v(e._s(e.session.ping)+"ms")])]):e._e(),t("li",{on:{click:e.copySessionUrl}},[e._v(" Kopiera spelarlänk "),t("em",[t("font-awesome-icon",{attrs:{icon:"copy"}})],1)]),e.session.isSpectator?e._e():t("li",{on:{click:e.distributeRoles}},[e._v(" Skicka karaktärer "),t("em",[t("font-awesome-icon",{attrs:{icon:"theater-masks"}})],1)]),e.session.voteHistory.length||!e.session.isSpectator?t("li",{on:{click:function(t){return e.toggleModal("voteHistory")}}},[e._v(" Rösthistorik"),t("em",[e._v("[V]")])]):e._e(),t("li",{on:{click:e.leaveSession}},[e._v(" Lämna Session "),t("em",[e._v(e._s(e.session.sessionId))])])]:[t("li",{on:{click:e.hostSession}},[e._v("Värd (Berättare)"),t("em",[e._v("[H]")])]),t("li",{on:{click:e.joinSession}},[e._v("Gå med (Spelare)"),t("em",[e._v("[J]")])])]]:e._e(),"players"!==e.tab||e.session.isSpectator?e._e():[t("li",{staticClass:"headline"},[e._v("Spelare")]),e.players.length<20?t("li",{on:{click:e.addPlayer}},[e._v("Lägg till"),t("em",[e._v("[A]")])]):e._e(),e.players.length>2?t("li",{on:{click:e.randomizeSeatings}},[e._v(" Slumpa platserna "),t("em",[t("font-awesome-icon",{attrs:{icon:"dice"}})],1)]):e._e(),e.players.length?t("li",{on:{click:e.clearPlayers}},[e._v(" Ta bort alla "),t("em",[t("font-awesome-icon",{attrs:{icon:"trash-alt"}})],1)]):e._e()],"characters"===e.tab?[t("li",{staticClass:"headline"},[e._v("Karaktärer")]),e.session.isSpectator?e._e():t("li",{on:{click:function(t){return e.toggleModal("edition")}}},[e._v(" Välj Utgåva "),t("em",[e._v("[E]")])]),!e.session.isSpectator&&e.players.length>4?t("li",{on:{click:function(t){return e.toggleModal("roles")}}},[e._v(" Välj & Tilldela "),t("em",[e._v("[C]")])]):e._e(),e.session.isSpectator?e._e():t("li",{on:{click:function(t){return e.toggleModal("fabled")}}},[e._v(" Lägg till Legend "),t("em",[t("font-awesome-icon",{attrs:{icon:"dragon"}})],1)]),e.players.length?t("li",{on:{click:e.clearRoles}},[e._v(" Ta bort alla "),t("em",[t("font-awesome-icon",{attrs:{icon:"trash-alt"}})],1)]):e._e()]:e._e(),"help"===e.tab?[t("li",{staticClass:"headline"},[e._v("Hjälp")]),t("li",{on:{click:function(t){return e.toggleModal("reference")}}},[e._v(" Karaktärsreferens "),t("em",[e._v("[R]")])]),t("li",{on:{click:function(t){return e.toggleModal("nightOrder")}}},[e._v(" Nattordningsblad "),t("em",[e._v("[N]")])]),t("li",{on:{click:function(t){return e.toggleModal("gameState")}}},[e._v(" Spelläge JSON "),t("em",[t("font-awesome-icon",{attrs:{icon:"file-code"}})],1)]),t("li",[t("a",{attrs:{href:"https://discord.gg/Gd7ybwWbFk",target:"_blank"}},[e._v(" Gå med i Discord ")]),t("em",[t("a",{attrs:{href:"https://discord.gg/Gd7ybwWbFk",target:"_blank"}},[t("font-awesome-icon",{attrs:{icon:["fab","discord"]}})],1)])]),t("li",[t("a",{attrs:{href:"https://github.com/bra1n/townsquare",target:"_blank"}},[e._v(" Källkod (ej denna tema utgåva) ")]),t("em",[t("a",{attrs:{href:"https://github.com/bra1n/townsquare",target:"_blank"}},[t("font-awesome-icon",{attrs:{icon:["fab","github"]}})],1)])]),e._m(0)]:e._e()],2)],1)])},ee=[function(){var e=this,t=e._self._c;return t("li",[t("span",[e._v("Version 1.0.1")])])}],te={computed:{...Object(r["d"])(["grimoire","session","edition"]),...Object(r["d"])("players",["players"])},data(){return{tab:"grimoire"}},methods:{setBackground(){const e=prompt("Enter custom background URL");(e||""===e)&&this.$store.commit("setBackground",e)},hostSession(){if(this.session.sessionId)return;const e=prompt("Ange ett kanalnummer / namn för din session",Math.round(1e4*Math.random()));e&&(this.$store.commit("session/clearVoteHistory"),this.$store.commit("session/setSpectator",!1),this.$store.commit("session/setSessionId",e),this.copySessionUrl())},copySessionUrl(){const e=window.location.href.split("#")[0],t=e+"#"+this.session.sessionId;navigator.clipboard.writeText(t)},distributeRoles(){if(this.session.isSpectator)return;const e="Vill du dela ut tilldelade karaktärer till alla SITTADE spelare?";confirm(e)&&(this.$store.commit("session/distributeRoles",!0),setTimeout((()=>{this.$store.commit("session/distributeRoles",!1)}).bind(this),2e3))},playFanfare(){if(this.session.isSpectator)return;const e="Vill du spela upp Tronsals fanfaren?";confirm(e)&&(this.$store.commit("session/setPlayFanfare",!0),console.log("true"),setTimeout((()=>{this.$store.commit("session/setPlayFanfare",!1),console.log("false")}).bind(this),5e3))},imageOptIn(){const e="Är du säker på att du vill tillåta egna bilder? En författare av en skadlig skriptfil kan spåra din IP-adress på detta sätt.";(this.grimoire.isImageOptIn||confirm(e))&&this.toggleImageOptIn()},joinSession(){if(this.session.sessionId)return this.leaveSession();let e=prompt("Ange kanalnumret / namnet på den session du vill gå med i");e.match(/^https?:\/\//i)&&(e=e.split("#").pop()),e&&(this.$store.commit("session/clearVoteHistory"),this.$store.commit("session/setSpectator",!0),this.$store.commit("toggleGrimoire",!1),this.$store.commit("session/setSessionId",e))},leaveSession(){confirm("Är du säker på att du vill lämna den aktiva spelomgången?")&&(this.$store.commit("session/setSpectator",!1),this.$store.commit("session/setSessionId",""))},addPlayer(){if(this.session.isSpectator)return;if(this.players.length>=20)return;const e=prompt("Spelarnamn");e&&this.$store.commit("players/add",e)},randomizeSeatings(){this.session.isSpectator||confirm("Är du säker på att du vill slump ut platserna?")&&this.$store.dispatch("players/randomize")},clearPlayers(){this.session.isSpectator||confirm("Är du säker på att du vill ta bort alla spelare?")&&(this.session.nomination&&this.$store.commit("session/nomination"),this.$store.commit("players/clear"))},clearRoles(){confirm("Är du säker på att du vill ta bort alla spelarroller?")&&this.$store.dispatch("players/clearRoles")},toggleNight(){this.$store.commit("toggleNight"),this.grimoire.isNight&&this.$store.commit("session/setMarkedPlayer",-1)},...Object(r["c"])(["toggleGrimoire","toggleMenu","toggleImageOptIn","toggleMuted","toggleNightOrder","toggleStatic","setZoom","toggleModal"])}},se=te,ie=(s("284f"),Object(f["a"])(se,X,ee,!1,null,"0749f85e",null)),ae=ie.exports,oe=function(){var e=this,t=e._self._c;return e.modals.roles&&e.nonTravelers>=5?t("Modal",{staticClass:"roles",on:{close:function(t){return e.toggleModal("roles")}}},[t("h3",[e._v("Välj karaktär för "+e._s(e.nonTravelers)+" spelaren:")]),e._l(e.roleSelection,(function(s,i){return t("ul",{key:i,staticClass:"tokens"},[t("li",{staticClass:"count",class:[i]},[e._v(" "+e._s(s.reduce((e,{selected:t})=>e+t,0))+" / "+e._s(e.game[e.nonTravelers-5][i])+" ")]),e._l(s,(function(s){return t("li",{key:s.id,class:[s.team,s.selected?"selected":""],on:{click:function(e){s.selected=s.selected?0:1}}},[t("Token",{attrs:{role:s}}),s.setup?t("font-awesome-icon",{attrs:{icon:"exclamation-triangle"}}):e._e(),e.allowMultiple?t("div",{staticClass:"buttons"},[t("font-awesome-icon",{attrs:{icon:"minus-circle"},on:{click:function(e){e.stopPropagation(),s.selected--}}}),t("span",[e._v(e._s(s.selected>1?"x"+s.selected:""))]),t("font-awesome-icon",{attrs:{icon:"plus-circle"},on:{click:function(e){e.stopPropagation(),s.selected++}}})],1):e._e()],1)}))],2)})),e.hasSelectedSetupRoles?t("div",{staticClass:"warning"},[t("font-awesome-icon",{attrs:{icon:"exclamation-triangle"}}),t("span",[e._v(" Varning: det finns utvalda karaktärer som ändrar speluppsättningen! Slumpgeneratorn tar inte hänsyn till dessa markörer. ")])],1):e._e(),t("label",{staticClass:"multiple",class:{checked:e.allowMultiple}},[t("font-awesome-icon",{attrs:{icon:e.allowMultiple?"check-square":"square"}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.allowMultiple,expression:"allowMultiple"}],attrs:{type:"checkbox",name:"allow-multiple"},domProps:{checked:Array.isArray(e.allowMultiple)?e._i(e.allowMultiple,null)>-1:e.allowMultiple},on:{change:function(t){var s=e.allowMultiple,i=t.target,a=!!i.checked;if(Array.isArray(s)){var o=null,r=e._i(s,o);i.checked?r<0&&(e.allowMultiple=s.concat([o])):r>-1&&(e.allowMultiple=s.slice(0,r).concat(s.slice(r+1)))}else e.allowMultiple=a}}}),e._v(" Tillåt dubbletter av karaktärer ")],1),t("div",{staticClass:"button-group"},[t("div",{staticClass:"button",class:{disabled:e.selectedRoles>e.nonTravelers||!e.selectedRoles},on:{click:e.assignRoles}},[t("font-awesome-icon",{attrs:{icon:"people-arrows"}}),e._v(" Tilldela "+e._s(e.selectedRoles)+" karaktärerna slumpmässigt ")],1),t("div",{staticClass:"button",on:{click:e.selectRandomRoles}},[t("font-awesome-icon",{attrs:{icon:"random"}}),e._v(" Blanda karaktärerna ")],1)])],2):e._e()},re=[];const ne=e=>e[Math.floor(Math.random()*e.length)];var le={components:{Token:y,Modal:x},data:function(){return{roleSelection:{},game:K,allowMultiple:!1}},computed:{selectedRoles:function(){return Object.values(this.roleSelection).map(e=>e.reduce((e,{selected:t})=>e+t,0)).reduce((e,t)=>e+t,0)},hasSelectedSetupRoles:function(){return Object.values(this.roleSelection).some(e=>e.some(e=>e.selected&&e.setup))},...Object(r["d"])(["roles","modals"]),...Object(r["d"])("players",["players"]),...Object(r["b"])({nonTravelers:"players/nonTravelers"})},methods:{selectRandomRoles(){this.roleSelection={},this.roles.forEach(e=>{this.roleSelection[e.team]||this.$set(this.roleSelection,e.team,[]),this.roleSelection[e.team].push(e),this.$set(e,"selected",0)}),delete this.roleSelection["traveler"];const e=Math.max(5,this.nonTravelers),t=this.game[e-5];Object.keys(t).forEach(e=>{for(let s=0;s<t[e];s++)if(this.roleSelection[e]){const t=this.roleSelection[e].filter(e=>!e.selected);t.length&&(ne(t).selected=1)}})},assignRoles(){if(this.selectedRoles<=this.nonTravelers&&this.selectedRoles){const e=Object.values(this.roleSelection).map(e=>e.reduce((e,t)=>[...e,...Array(t.selected).fill(t)],[])).reduce((e,t)=>[...e,...t],[]).map(e=>[Math.random(),e]).sort((e,t)=>e[0]-t[0]).map(e=>e[1]);this.players.forEach(t=>{if("traveler"!==t.role.team&&e.length){const s=e.pop();this.$store.commit("players/update",{player:t,property:"role",value:s})}}),this.$store.commit("toggleModal","roles")}},...Object(r["c"])(["toggleModal"])},mounted:function(){Object.keys(this.roleSelection).length||this.selectRandomRoles()},watch:{roles(){this.selectRandomRoles()}}},ce=le,de=(s("3d41"),Object(f["a"])(ce,oe,re,!1,null,"5d4135d0",null)),me=de.exports,he=function(){var e=this,t=e._self._c;return e.modals.edition?t("Modal",{staticClass:"editions",on:{close:function(t){return e.toggleModal("edition")}}},[e.isCustom?t("div",{staticClass:"custom"},[t("h3",[e._v("Load custom script / characters")]),e._v(" To play with a custom script, you need to select the characters you want to play with in the official "),t("a",{attrs:{href:"https://script.bloodontheclocktower.com/",target:"_blank"}},[e._v("Script Tool")]),e._v(' and then upload the generated "custom-list.json" either directly here or provide a URL to such a hosted JSON file.'),t("br"),t("br"),e._v(" To play with custom characters, please read "),t("a",{attrs:{href:"https://github.com/bra1n/townsquare#custom-characters",target:"_blank"}},[e._v("the documentation")]),e._v(" on how to write a custom character definition file. "),t("b",[e._v("Only load custom JSON files from sources that you trust!")]),t("h3",[e._v("Some popular custom scripts:")]),t("ul",{staticClass:"scripts"},e._l(e.scripts,(function(s,i){return t("li",{key:i,on:{click:function(t){return e.handleURL(s[1])}}},[e._v(" "+e._s(s[0])+" ")])})),0),t("input",{ref:"upload",attrs:{type:"file",accept:"application/json"},on:{change:e.handleUpload}}),t("div",{staticClass:"button-group"},[t("div",{staticClass:"button",on:{click:e.openUpload}},[t("font-awesome-icon",{attrs:{icon:"file-upload"}}),e._v(" Upload JSON ")],1),t("div",{staticClass:"button",on:{click:e.promptURL}},[t("font-awesome-icon",{attrs:{icon:"link"}}),e._v(" Enter URL ")],1),t("div",{staticClass:"button",on:{click:e.readFromClipboard}},[t("font-awesome-icon",{attrs:{icon:"clipboard"}}),e._v(" Use JSON from Clipboard ")],1),t("div",{staticClass:"button",on:{click:function(t){e.isCustom=!1}}},[t("font-awesome-icon",{attrs:{icon:"undo"}}),e._v(" Back ")],1)])]):t("div",[t("h3",[e._v("Välj utgåva:")]),t("ul",{staticClass:"editions"},[e._l(e.editions,(function(i){return t("li",{key:i.id,staticClass:"edition",class:["edition-"+i.id],style:{backgroundImage:`url(${s("ce23")("./"+i.id+".png")})`},on:{click:function(t){return e.setEdition(i)}}},[e._v(" "+e._s(i.name)+" ")])})),t("li",{staticClass:"edition edition-custom",style:{backgroundImage:`url(${s("441d")})`},on:{click:function(t){e.isCustom=!0}}},[e._v(" Custom Script / Characters ")])],2)])]):e._e()},pe=[],ge=s("00c0"),ue={components:{Modal:x},data:function(){return{editions:ge,isCustom:!1,scripts:[["Deadly Penance Day","https://gist.githubusercontent.com/bra1n/0337cc44c6fd2c44f7589256ed5486d2/raw/16be38fa3c01aaf49827303ac80577bdb52c0b25/penanceday.json"],["Catfishing 11.1","https://gist.githubusercontent.com/bra1n/8a5ec41a7bbf945f6b7dfc1cef72b569/raw/a312ab93c2f302e0ef83c8b65a4e8e82760fda3a/catfishing.json"],["On Thin Ice (Teensyville)","https://gist.githubusercontent.com/bra1n/8dacd9f2abc6f428331ea1213ab153f5/raw/0cacbcaf8ed9bddae0cca25a9ada97e9958d868b/on-thin-ice.json"],["Race To The Bottom (Teensyville)","https://gist.githubusercontent.com/bra1n/63e1354cb3dc9d4032bcd0623dc48888/raw/5acb0eedcc0a67a64a99c7e0e6271de0b7b2e1b2/race-to-the-bottom.json"],["Frankenstein's Mayor by Ted (Teensyville)","https://gist.githubusercontent.com/bra1n/32c52b422cc01b934a4291eeb81dbcee/raw/5bf770693bbf7aff5e86601c82ca4af3222f4ba6/Frankensteins_Mayor_by_Ted.json"],["Vigormortis High School (Teensyville)","https://gist.githubusercontent.com/bra1n/1f65bd4a999524719d5dabe98c3c2d27/raw/22bbec6bf56a51a7459e5ae41ed47e41971c5445/VigormortisHighSchool.json"]]}},computed:Object(r["d"])(["modals"]),methods:{openUpload(){this.$refs.upload.click()},handleUpload(){const e=this.$refs.upload.files[0];if(e&&e.size){const t=new FileReader;t.addEventListener("load",()=>{try{const e=JSON.parse(t.result);this.parseRoles(e)}catch(e){alert("Error reading custom script: "+e.message)}this.$refs.upload.value=""}),t.readAsText(e)}},promptURL(){const e=prompt("Enter URL to a custom-script.json file");e&&this.handleURL(e)},async handleURL(e){const t=await fetch(e);if(t&&t.json)try{const e=await t.json();this.parseRoles(e)}catch(s){alert("Error loading custom script: "+s.message)}},async readFromClipboard(){const e=await navigator.clipboard.readText();try{const t=JSON.parse(e);this.parseRoles(t)}catch(t){alert("Error reading custom script: "+t.message)}},parseRoles(e){if(!e||!e.length)return;const t=e.findIndex(({id:e})=>"_meta"===e);let s={};if(t>-1&&(s=e.splice(t,1).pop()),this.$store.commit("setCustomRoles",e),this.$store.commit("setEdition",Object.assign({},s,{id:"custom"})),e.some(({id:e})=>this.$store.state.fabled.has(e))){const t=[];e.forEach(({id:e})=>{this.$store.state.fabled.has(e)&&t.push(this.$store.state.fabled.get(e))}),this.$store.commit("players/setFabled",{fabled:t})}this.isCustom=!1},...Object(r["c"])(["toggleModal","setEdition"])}},fe=ue,ve=(s("0a61"),Object(f["a"])(fe,he,pe,!1,null,"92778fd4",null)),ye=ve.exports,be=function(){var e=this,t=e._self._c;return t("div",{staticClass:"intro"},[t("img",{staticClass:"logo",attrs:{src:s("9426"),alt:""}}),t("div",[e._v(" Välkommen till den virtuella "),t("b",[e._v("Tronsalen och de Kungliga Hemligheternas Bok")]),e._v(" för Struggle in the Tower! Lägg till fler spelare genom "),t("span",{staticClass:"button",on:{click:e.toggleMenu}},[t("font-awesome-icon",{attrs:{icon:"cog"}}),e._v(" Meny ")],1),e._v(" uppe till höger eller genom att trycka "),t("b",[e._v("[A]")]),e._v(". Du kan också gå med i en spelsession genom att trycka på "),t("b",[e._v("[J]")]),e._v("."),t("br"),e._m(0)]),"zh-CN"===e.language?t("a",{staticClass:"redirect",attrs:{href:"https://clocktower.gstonegames.com"}},[t("img",{staticClass:"gstone",attrs:{src:s("dd41"),alt:""}}),e._v(" 你想使用中文版魔典吗？ ")]):e._e()])},ke=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"footer"},[e._v(" Det här projektet är gratis och med öppen källkod samt en ny version med nytt tema av spelet Blood on the Clocktower. Huvudrepo finns på "),t("a",{attrs:{href:"https://github.com/bra1n/townsquare",target:"_blank"}},[e._v("GitHub")]),e._v('. Det är inte kopplat till Pandemonium Institute. "Blood on the Clocktower" är ett varumärke för Steven Medway och The Pandemonium Institute. ')])}],_e={data(){return{language:window.navigator.userLanguage||window.navigator.language}},methods:Object(r["c"])(["toggleMenu"])},Se=_e,we=(s("ce15"),Object(f["a"])(Se,be,ke,!1,null,"4b6f789c",null)),Ne=we.exports,Oe=function(){var e=this,t=e._self._c;return e.modals.reference&&e.roles.size?t("Modal",{staticClass:"characters",on:{close:function(t){return e.toggleModal("reference")}}},[t("font-awesome-icon",{staticClass:"toggle",attrs:{icon:"cloud-moon",title:"Show Night Order"},on:{click:function(t){return e.toggleModal("nightOrder")}}}),t("h3",[e._v(" Karaktärsreferens "),t("font-awesome-icon",{attrs:{icon:"address-card"}}),e._v(" "+e._s(e.edition.name||"Custom Script")+" ")],1),e._l(e.rolesGrouped,(function(i,a){return t("div",{key:a,class:["team",a]},[t("aside",[t("h4",[e._v(" "+e._s("townsfolk"===a?"Hovfolk":"outsider"===a?"Hushållet":"minion"===a?"Hantlangare":"demon"===a?"Troninkräktare":"")+" ")])]),t("ul",[e._l(i,(function(i){return t("li",{key:i.id,class:[a]},[i.id?t("span",{staticClass:"icon",style:{backgroundImage:`url(${i.image&&e.grimoire.isImageOptIn?i.image:s("6f32")("./"+(i.imageAlt||i.id)+".svg")})`}}):e._e(),t("div",{staticClass:"role"},[Object.keys(e.playersByRole).length?t("span",{staticClass:"player"},[e._v(e._s(e.playersByRole[i.id]?e.playersByRole[i.id].join(", "):""))]):e._e(),t("span",{staticClass:"name"},[e._v(e._s(i.name))]),t("span",{staticClass:"ability"},[e._v(e._s(i.ability))])])])})),t("li",{class:[a]}),t("li",{class:[a]})],2)])})),e.jinxed.length?t("div",{staticClass:"team jinxed"},[t("aside",[t("h4",[e._v("Jinxed")])]),t("ul",[e._l(e.jinxed,(function(i,a){return t("li",{key:a},[t("span",{staticClass:"icon",style:{backgroundImage:`url(${s("61b0")("./"+i.first.id+".png")})`}}),t("span",{staticClass:"icon",style:{backgroundImage:`url(${s("61b0")("./"+i.second.id+".png")})`}}),t("div",{staticClass:"role"},[t("span",{staticClass:"name"},[e._v(e._s(i.first.name)+" & "+e._s(i.second.name))]),t("span",{staticClass:"ability"},[e._v(e._s(i.reason))])])])})),t("li"),t("li")],2)]):e._e()],2):e._e()},Ie=[],Me={components:{Modal:x},computed:{jinxed:function(){const e=[];return this.roles.forEach(t=>{this.jinxes.get(t.id)&&this.jinxes.get(t.id).forEach((s,i)=>{this.roles.get(i)&&e.push({first:t,second:this.roles.get(i),reason:s})})}),e},rolesGrouped:function(){const e={};return this.roles.forEach(t=>{e[t.team]||(e[t.team]=[]),e[t.team].push(t)}),delete e["traveler"],e},playersByRole:function(){const e={};return this.players.forEach(({name:t,role:s})=>{s&&s.id&&"traveler"!==s.team&&(e[s.id]||(e[s.id]=[]),e[s.id].push(t))}),e},...Object(r["d"])(["roles","modals","edition","grimoire","jinxes"]),...Object(r["d"])("players",["players"])},methods:{...Object(r["c"])(["toggleModal"])}},Ce=Me,Re=(s("e1bc"),Object(f["a"])(Ce,Oe,Ie,!1,null,"69994648",null)),xe=Re.exports,Pe=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"vote"}},[t("div",{staticClass:"arrows"},[t("span",{staticClass:"nominee",style:e.nomineeStyle}),t("span",{staticClass:"nominator",style:e.nominatorStyle})]),t("div",{staticClass:"overlay"},[t("audio",{attrs:{src:s("f6a8"),preload:"auto"}}),t("em",{staticClass:"blue"},[e._v(e._s(e.nominator.name))]),e._v(" nominerade "),t("em",[e._v(e._s(e.nominee.name))]),e._v("! "),t("br"),t("em",{staticClass:"blue"},[e._v(" "+e._s(e.voters.length)+" röst"+e._s(1!==e.voters.length?"er":"")+" ")]),e._v(" för "),"traveler"!==e.nominee.role.team?t("em",[e._v(" (majoritet är "+e._s(Math.ceil(e.alive/2))+") ")]):t("em",[e._v("(majoritet är "+e._s(Math.ceil(e.players.length/2))+")")]),e.session.isSpectator?e.canVote?[e.session.isVoteInProgress?e._e():t("div",[e._v(" "+e._s(e.session.votingSpeed/1e3)+" sekunder mellan röster ")]),t("div",{staticClass:"button-group"},[t("div",{staticClass:"button townsfolk",class:{disabled:!e.currentVote},on:{click:function(t){return e.vote(!1)}}},[e._v(" Hand NER ")]),t("div",{staticClass:"button demon",class:{disabled:e.currentVote},on:{click:function(t){return e.vote(!0)}}},[e._v(" Hand UPP ")])])]:e.player?e._e():t("div",[e._v(" Vänligen ta en plats för att rösta. ")]):[!e.session.isVoteInProgress&&e.session.lockedVote<1?t("div",[e._v(" Tid per spelare: "),t("font-awesome-icon",{attrs:{icon:"minus-circle"},on:{mousedown:function(t){return t.preventDefault(),e.setVotingSpeed(-500)}}}),e._v(" "+e._s(e.session.votingSpeed/1e3)+"s "),t("font-awesome-icon",{attrs:{icon:"plus-circle"},on:{mousedown:function(t){return t.preventDefault(),e.setVotingSpeed(500)}}})],1):e._e(),t("div",{staticClass:"button-group"},[e.session.isVoteInProgress?e._e():t("div",{staticClass:"button townsfolk",on:{click:e.countdown}},[e._v(" Nedräkning ")]),e.session.isVoteInProgress?[t("div",{staticClass:"button townsfolk",class:{disabled:!e.session.lockedVote},on:{click:e.pause}},[e._v(" "+e._s(e.voteTimer?"Paus":"Återstart")+" ")]),t("div",{staticClass:"button",on:{click:e.stop}},[e._v("Återställ")])]:t("div",{staticClass:"button",on:{click:e.start}},[e._v(" "+e._s(e.session.lockedVote?"Återställ":"Starta")+" ")]),t("div",{staticClass:"button demon",on:{click:e.finish}},[e._v("Stäng")])],2),"traveler"!==e.nominee.role.team?t("div",{staticClass:"button-group mark"},[t("div",{staticClass:"button",class:{disabled:e.session.nomination[1]===e.session.markedPlayer},on:{click:e.setMarked}},[e._v(" Märk för utkastning ")]),t("div",{staticClass:"button",on:{click:e.removeMarked}},[e._v(" Rensa märkning ")])]):e._e()]],2),t("transition",{attrs:{name:"blur"}},[e.session.isVoteInProgress&&!e.session.lockedVote?t("div",{staticClass:"countdown"},[t("span",[e._v("3")]),t("span",[e._v("2")]),t("span",[e._v("1")]),t("span",[e._v("BÖRJA")]),t("audio",{attrs:{autoplay:!e.grimoire.isMuted,src:s("f6a8"),muted:e.grimoire.isMuted}})]):e._e()])],1)},je=[],Ve={computed:{...Object(r["d"])("players",["players"]),...Object(r["d"])(["session","grimoire"]),...Object(r["b"])({alive:"players/alive"}),nominator:function(){return this.players[this.session.nomination[0]]},nominatorStyle:function(){const e=this.players.length,t=this.session.nomination[0];return{transform:`rotate(${Math.round(t/e*360)}deg)`,transitionDuration:this.session.votingSpeed-100+"ms"}},nominee:function(){return this.players[this.session.nomination[1]]},nomineeStyle:function(){const e=this.players.length,t=this.session.nomination[1],s=this.session.lockedVote,i=360*(t+Math.min(s,e))/e;return{transform:`rotate(${Math.round(i)}deg)`,transitionDuration:this.session.votingSpeed-100+"ms"}},player:function(){return this.players.find(e=>e.id===this.session.playerId)},currentVote:function(){const e=this.players.findIndex(e=>e.id===this.session.playerId);return e>=0?!!this.session.votes[e]:void 0},canVote:function(){if(!this.player)return!1;if(this.player.isVoteless&&"traveler"!==this.nominee.role.team)return!1;const e=this.session,t=this.players.length,s=this.players.indexOf(this.player),i=(s-1+t-e.nomination[1])%t;return i>=e.lockedVote-1},voters:function(){const e=this.session.nomination[1],t=Array(this.players.length).fill("").map((e,t)=>this.session.votes[t]?this.players[t].name:""),s=[...t.slice(e+1),...t.slice(0,e+1)];return(this.session.lockedVote?s.slice(0,this.session.lockedVote-1):s).filter(e=>!!e)}},data(){return{voteTimer:null}},methods:{countdown(){this.$store.commit("session/lockVote",0),this.$store.commit("session/setVoteInProgress",!0),this.voteTimer=setInterval(()=>{this.start()},4e3)},start(){this.$store.commit("session/lockVote",1),this.$store.commit("session/setVoteInProgress",!0),clearInterval(this.voteTimer),this.voteTimer=setInterval(()=>{this.$store.commit("session/lockVote"),this.session.lockedVote>this.players.length&&(clearInterval(this.voteTimer),this.$store.commit("session/setVoteInProgress",!1))},this.session.votingSpeed)},pause(){this.voteTimer?(clearInterval(this.voteTimer),this.voteTimer=null):this.voteTimer=setInterval(()=>{this.$store.commit("session/lockVote"),this.session.lockedVote>this.players.length&&(clearInterval(this.voteTimer),this.$store.commit("session/setVoteInProgress",!1))},this.session.votingSpeed)},stop(){clearInterval(this.voteTimer),this.voteTimer=null,this.$store.commit("session/setVoteInProgress",!1),this.$store.commit("session/lockVote",0)},finish(){clearInterval(this.voteTimer),this.$store.commit("session/addHistory",this.players),this.$store.commit("session/nomination")},vote(e){if(!this.canVote)return!1;const t=this.players.findIndex(e=>e.id===this.session.playerId);t>=0&&!!this.session.votes[t]!==e&&this.$store.commit("session/voteSync",[t,e])},setVotingSpeed(e){const t=Math.round(this.session.votingSpeed+e);t>0&&this.$store.commit("session/setVotingSpeed",t)},setMarked(){this.$store.commit("session/setMarkedPlayer",this.session.nomination[1])},removeMarked(){this.$store.commit("session/setMarkedPlayer",-1)}}},Te=Ve,$e=(s("5768"),Object(f["a"])(Te,Pe,je,!1,null,"63fb6cea",null)),He=$e.exports,Fe=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"gradients"}},e._l(e.gradients,(function(e,s){return t("svg",{key:s,attrs:{width:"0",height:"0"}},[t("linearGradient",{attrs:{id:e[0],x1:"50%",y1:"100%",x2:"50%",y2:"0%"}},[t("stop",{style:{"stop-color":e[2],"stop-opacity":1},attrs:{offset:"0%"}}),t("stop",{style:{"stop-color":e[1],"stop-opacity":1},attrs:{offset:"100%"}})],1)],1)})),0)},De=[],Ee={data(){return{gradients:[["demon","#ce0100","#000"],["townsfolk","#1f65ff","#000"],["default","#4E4E4E","#000"]]}}},Le=Ee,Ge=(s("05a5"),Object(f["a"])(Le,Fe,De,!1,null,"1e202a64",null)),Ae=Ge.exports,Be=function(){var e=this,t=e._self._c;return e.modals.nightOrder&&e.roles.size?t("Modal",{staticClass:"night-reference",on:{close:function(t){return e.toggleModal("nightOrder")}}},[t("font-awesome-icon",{staticClass:"toggle",attrs:{icon:"address-card",title:"Show Character Reference"},on:{click:function(t){return e.toggleModal("reference")}}}),t("h3",[e._v(" Nattordning "),t("font-awesome-icon",{attrs:{icon:"cloud-moon"}}),e._v(" "+e._s(e.edition.name||"Custom Script")+" ")],1),t("div",{staticClass:"night"},[t("ul",{staticClass:"first"},[t("li",{staticClass:"headline"},[e._v("Första Natten")]),e._l(e.rolesFirstNight,(function(i){return t("li",{key:i.name,class:[i.team]},[t("span",{staticClass:"name"},[e._v(" "+e._s(i.name)+" "),i.players.length?t("span",{staticClass:"player"},[t("br"),e._l(i.players,(function(s,a){return t("small",{key:a,class:{dead:s.isDead}},[e._v(e._s(s.name+(i.players.length>a+1?",":"")))])}))],2):e._e()]),i.id?t("span",{staticClass:"icon",style:{backgroundImage:`url(${i.image&&e.grimoire.isImageOptIn?i.image:s("6f32")("./"+(i.imageAlt||i.id)+".svg")})`}}):e._e(),i.firstNightReminder?t("span",{staticClass:"reminder"},[e._v(" "+e._s(i.firstNightReminder)+" ")]):e._e()])}))],2),t("ul",{staticClass:"other"},[t("li",{staticClass:"headline"},[e._v("Övriga Nätter")]),e._l(e.rolesOtherNight,(function(i){return t("li",{key:i.name,class:[i.team]},[i.id?t("span",{staticClass:"icon",style:{backgroundImage:`url(${i.image&&e.grimoire.isImageOptIn?i.image:s("6f32")("./"+(i.imageAlt||i.id)+".svg")})`}}):e._e(),t("span",{staticClass:"name"},[e._v(" "+e._s(i.name)+" "),i.players.length?t("span",{staticClass:"player"},[t("br"),e._l(i.players,(function(s,a){return t("small",{key:a,class:{dead:s.isDead}},[e._v(e._s(s.name+(i.players.length>a+1?",":"")))])}))],2):e._e()]),i.otherNightReminder?t("span",{staticClass:"reminder"},[e._v(" "+e._s(i.otherNightReminder)+" ")]):e._e()])}))],2)])],1):e._e()},ze=[],Je={components:{Modal:x},computed:{rolesFirstNight:function(){const e=[];return this.players.length>6&&e.push({id:"evil",name:"Hantlangar info",firstNight:5,team:"minion",players:this.players.filter(e=>"minion"===e.role.team),firstNightReminder:'• Om mer än en Hantlangare, se att alla får ögonkontakt med varandra.• Visa kortet "Detta är Troninkräktaren". Peka på Troninkräktaren.'},{id:"evil",name:"Troninkräktarens info & bluffar",firstNight:8,team:"demon",players:this.players.filter(e=>"demon"===e.role.team),firstNightReminder:'• Visa kortet "Dessa är dina Hantlangare". Peka på varje Hantlangare.• Visa kortet “Dessa karaktärer är inte i spel”. Visa 3 karaktärmarkörer av lojala karaktärer inte i spel.'}),this.roles.forEach(t=>{const s=this.players.filter(e=>e.role.id===t.id);t.firstNight&&("traveler"!==t.team||s.length)&&e.push(Object.assign({players:s},t))}),this.fabled.filter(({firstNight:e})=>e).forEach(t=>{e.push(Object.assign({players:[]},t))}),e.sort((e,t)=>e.firstNight-t.firstNight),e},rolesOtherNight:function(){const e=[];return this.roles.forEach(t=>{const s=this.players.filter(e=>e.role.id===t.id);t.otherNight&&("traveler"!==t.team||s.length)&&e.push(Object.assign({players:s},t))}),this.fabled.filter(({otherNight:e})=>e).forEach(t=>{e.push(Object.assign({players:[]},t))}),e.sort((e,t)=>e.otherNight-t.otherNight),e},...Object(r["d"])(["roles","modals","edition","grimoire"]),...Object(r["d"])("players",["players","fabled"])},methods:{...Object(r["c"])(["toggleModal"])}},Ue=Je,qe=(s("5132"),Object(f["a"])(Ue,Be,ze,!1,null,"39091f8b",null)),Ke=qe.exports,We=function(){var e=this,t=e._self._c;return e.modals.fabled&&e.fabled.length?t("Modal",{on:{close:function(t){return e.toggleModal("fabled")}}},[t("h3",[e._v(" Välj Legender karaktärer att lägga till i spelet ")]),t("ul",{staticClass:"tokens"},e._l(e.fabled,(function(s){return t("li",{key:s.id,on:{click:function(t){return e.setFabled(s)}}},[t("Token",{attrs:{role:s}})],1)})),0)]):e._e()},Ze=[],Qe={components:{Token:y,Modal:x},computed:{...Object(r["d"])(["modals","fabled","grimoire"]),fabled(){const e=[];return this.$store.state.fabled.forEach(t=>{this.$store.state.players.fabled.some(e=>e.id===t.id)||e.push(t)}),e}},methods:{setFabled(e){this.$store.commit("players/setFabled",{fabled:e}),this.$store.commit("toggleModal","fabled")},...Object(r["c"])(["toggleModal"])}},Ye=Qe,Xe=(s("589c"),Object(f["a"])(Ye,We,Ze,!1,null,"10ed11dd",null)),et=Xe.exports,tt=function(){var e=this,t=e._self._c;return!e.modals.voteHistory||!e.session.voteHistory&&e.session.isSpectator?e._e():t("Modal",{staticClass:"vote-history",on:{close:function(t){return e.toggleModal("voteHistory")}}},[e.session.isSpectator?t("font-awesome-icon",{staticClass:"clear",attrs:{icon:"trash-alt",title:"Clear vote history"},on:{click:e.clearVoteHistory}}):e._e(),t("h3",[e._v("Rösthistorik")]),e.session.isSpectator?e._e():[t("div",{staticClass:"options"},[t("div",{staticClass:"option",on:{click:e.setRecordVoteHistory}},[t("font-awesome-icon",{attrs:{icon:["fas",e.session.isVoteHistoryAllowed?"check-square":"square"]}}),e._v(" Tillgänglig för spelarna ")],1),t("div",{staticClass:"option",on:{click:e.clearVoteHistory}},[t("font-awesome-icon",{attrs:{icon:"trash-alt"}}),e._v(" Rensa för alla ")],1)])],t("table",[t("thead",[t("tr",[t("td",[e._v("Tid")]),t("td",[e._v("Nominator")]),t("td",[e._v("Kandidat")]),t("td",[e._v("Typ")]),t("td",[e._v("Röster")]),t("td",[e._v("Majoritet")]),t("td",[t("font-awesome-icon",{attrs:{icon:"user-friends"}}),e._v(" Väljare ")],1)])]),t("tbody",e._l(e.session.voteHistory,(function(s,i){return t("tr",{key:i},[t("td",[e._v(" "+e._s(s.timestamp.getHours().toString().padStart(2,"0"))+":"+e._s(s.timestamp.getMinutes().toString().padStart(2,"0"))+" ")]),t("td",[e._v(e._s(s.nominator))]),t("td",[e._v(e._s(s.nominee))]),t("td",[e._v(e._s(s.type))]),t("td",[e._v(" "+e._s(s.votes.length)+" "),t("font-awesome-icon",{attrs:{icon:"hand-paper"}})],1),t("td",[e._v(" "+e._s(s.majority)+" "),t("font-awesome-icon",{attrs:{icon:["fas",s.votes.length>=s.majority?"check-square":"square"]}})],1),t("td",[e._v(" "+e._s(s.votes.join(", "))+" ")])])})),0)])],2)},st=[],it={components:{Modal:x},computed:{...Object(r["d"])(["session","modals"])},methods:{clearVoteHistory(){this.$store.commit("session/clearVoteHistory")},setRecordVoteHistory(){this.$store.commit("session/setVoteHistoryAllowed",!this.session.isVoteHistoryAllowed)},...Object(r["c"])(["toggleModal"])}},at=it,ot=(s("0548"),Object(f["a"])(at,tt,st,!1,null,"9e04e098",null)),rt=ot.exports,nt=function(){var e=this,t=e._self._c;return e.modals.gameState?t("Modal",{staticClass:"game-state",on:{close:function(t){return e.toggleModal("gameState")}}},[t("h3",[e._v("Aktuellt spelläge")]),t("textarea",{domProps:{value:e.gamestate},on:{input:function(t){t.stopPropagation(),e.input=t.target.value},click:function(e){return e.target.select()},keyup:function(e){e.stopPropagation()}}}),t("div",{staticClass:"button-group"},[t("div",{staticClass:"button townsfolk",on:{click:e.copy}},[t("font-awesome-icon",{attrs:{icon:"copy"}}),e._v(" Kopiera JSON ")],1),e.session.isSpectator?e._e():t("div",{staticClass:"button demon",on:{click:e.load}},[t("font-awesome-icon",{attrs:{icon:"cog"}}),e._v(" Ladda läge ")],1)])]):e._e()},lt=[],ct={components:{Modal:x},computed:{gamestate:function(){return JSON.stringify({bluffs:this.players.bluffs.map(({id:e})=>e),edition:this.edition.isOfficial?{id:this.edition.id}:this.edition,roles:this.edition.isOfficial?"":this.$store.getters.customRolesStripped,fabled:this.players.fabled.map(e=>e.isCustom?e:{id:e.id}),players:this.players.players.map(e=>({...e,role:e.role.id||{}}))})},...Object(r["d"])(["modals","players","edition","roles","session"])},data(){return{input:""}},methods:{copy:function(){navigator.clipboard.writeText(this.input||this.gamestate)},load:function(){if(!this.session.isSpectator)try{const e=JSON.parse(this.input||this.gamestate),{bluffs:t,edition:s,roles:i,fabled:a,players:o}=e;i&&this.$store.commit("setCustomRoles",i),s&&this.$store.commit("setEdition",s),t.length&&t.forEach((e,t)=>{this.$store.commit("players/setBluff",{index:t,role:this.$store.state.roles.get(e)||{}})}),a&&this.$store.commit("players/setFabled",{fabled:a.map(e=>this.$store.state.fabled.get(e)||this.$store.state.fabled.get(e.id)||e)}),o&&this.$store.commit("players/set",o.map(e=>({...e,role:this.$store.state.roles.get(e.role)||this.$store.getters.rolesJSONbyId.get(e.role)||{}}))),this.toggleModal("gameState")}catch(e){alert("Unable to parse JSON: "+e)}},...Object(r["c"])(["toggleModal"])}},dt=ct,mt=(s("3425"),Object(f["a"])(dt,nt,lt,!1,null,"d61bce48",null)),ht=mt.exports,pt={components:{GameStateModal:ht,VoteHistoryModal:rt,FabledModal:et,NightOrderModal:Ke,Vote:He,ReferenceModal:xe,Intro:Ne,TownInfo:Y,TownSquare:J,Menu:ae,EditionModal:ye,RolesModal:me,Gradients:Ae},computed:{...Object(r["d"])(["grimoire","session"]),...Object(r["d"])("players",["players"])},data(){return{version:n["a"]}},methods:{keyup({key:e,ctrlKey:t,metaKey:s}){if(!t&&!s)switch(e.toLocaleLowerCase()){case"g":this.$store.commit("toggleGrimoire");break;case"a":this.$refs.menu.addPlayer();break;case"f":this.$refs.menu.playFanfare();break;case"h":this.$refs.menu.hostSession();break;case"j":this.$refs.menu.joinSession();break;case"r":this.$store.commit("toggleModal","reference");break;case"n":this.$store.commit("toggleModal","nightOrder");break;case"e":if(this.session.isSpectator)return;this.$store.commit("toggleModal","edition");break;case"c":if(this.session.isSpectator)return;this.$store.commit("toggleModal","roles");break;case"v":!this.session.voteHistory.length&&this.session.isSpectator||this.$store.commit("toggleModal","voteHistory");break;case"s":if(this.session.isSpectator)return;this.$refs.menu.toggleNight();break;case"escape":this.$store.commit("toggleModal")}}}},gt=pt,ut=(s("68e4"),Object(f["a"])(gt,a,o,!1,null,null,null)),ft=ut.exports,vt=s("dfb1"),yt=s.n(vt);class bt{constructor(e){this._wss="wss://live.clocktower.online:8080/",this._socket=null,this._isSpectator=!0,this._gamestate=[],this._store=e,this._pingInterval=3e4,this._pingTimer=null,this._reconnectTimer=null,this._players={},this._pings={},this._store.state.session.sessionId&&this.connect(this._store.state.session.sessionId)}_open(e){this.disconnect(),this._socket=new WebSocket(this._wss+e+"/"+(this._isSpectator?this._store.state.session.playerId:"host")),this._socket.addEventListener("message",this._handleMessage.bind(this)),this._socket.onopen=this._onOpen.bind(this),this._socket.onclose=t=>{this._socket=null,clearInterval(this._pingTimer),this._pingTimer=null,1e3!==t.code?(this._store.commit("session/setReconnecting",!0),this._reconnectTimer=setTimeout(()=>this.connect(e),3e3)):(this._store.commit("session/setSessionId",""),t.reason&&alert(t.reason))}}_send(e,t){this._socket&&1===this._socket.readyState&&this._socket.send(JSON.stringify([e,t]))}_sendDirect(e,t,s){e?this._send("direct",{[e]:[t,s]}):this._send(t,s)}_onOpen(){this._isSpectator?this._sendDirect("host","getGamestate",this._store.state.session.playerId):this.sendGamestate(),this._ping()}_ping(){this._handlePing(),this._send("ping",[this._isSpectator?this._store.state.session.playerId:Object.keys(this._players).length,"latency"]),clearTimeout(this._pingTimer),this._pingTimer=setTimeout(this._ping.bind(this),this._pingInterval)}_handleMessage({data:e}){let t,s;try{[t,s]=JSON.parse(e)}catch(i){console.log("unsupported socket message",e)}switch(t){case"getGamestate":this.sendGamestate(s);break;case"edition":this._updateEdition(s);break;case"fabled":this._updateFabled(s);break;case"gs":this._updateGamestate(s);break;case"player":this._updatePlayer(s);break;case"claim":this._updateSeat(s);break;case"ping":this._handlePing(s);break;case"nomination":if(!this._isSpectator)return;s||this._store.commit("session/addHistory",this._store.state.players.players),this._store.commit("session/nomination",{nomination:s});break;case"swap":if(!this._isSpectator)return;this._store.commit("players/swap",s);break;case"move":if(!this._isSpectator)return;this._store.commit("players/move",s);break;case"remove":if(!this._isSpectator)return;this._store.commit("players/remove",s);break;case"marked":if(!this._isSpectator)return;this._store.commit("session/setMarkedPlayer",s);break;case"isNight":if(!this._isSpectator)return;this._store.commit("toggleNight",s);break;case"isVoteHistoryAllowed":if(!this._isSpectator)return;this._store.commit("session/setVoteHistoryAllowed",s),this._store.commit("session/clearVoteHistory");break;case"votingSpeed":if(!this._isSpectator)return;this._store.commit("session/setVotingSpeed",s);break;case"clearVoteHistory":if(!this._isSpectator)return;this._store.commit("session/clearVoteHistory");break;case"isPlayFanfare":this._store.commit("session/setPlayFanfare",s);break;case"isVoteInProgress":if(!this._isSpectator)return;this._store.commit("session/setVoteInProgress",s);break;case"vote":this._handleVote(s);break;case"lock":this._handleLock(s);break;case"bye":this._handleBye(s);break;case"pronouns":this._updatePlayerPronouns(s);break}}connect(e){this._store.state.session.playerId||this._store.commit("session/setPlayerId",Math.random().toString(36).substr(2)),this._pings={},this._store.commit("session/setPlayerCount",0),this._store.commit("session/setPing",0),this._isSpectator=this._store.state.session.isSpectator,this._open(e)}disconnect(){this._pings={},this._store.commit("session/setPlayerCount",0),this._store.commit("session/setPing",0),this._store.commit("session/setReconnecting",!1),clearTimeout(this._reconnectTimer),this._socket&&(this._isSpectator&&this._sendDirect("host","bye",this._store.state.session.playerId),this._socket.close(1e3),this._socket=null)}sendGamestate(e="",t=!1){if(!this._isSpectator)if(this._gamestate=this._store.state.players.players.map(e=>({name:e.name,id:e.id,isDead:e.isDead,isVoteless:e.isVoteless,pronouns:e.pronouns,...e.role&&"traveler"===e.role.team?{roleId:e.role.id}:{}})),t)this._sendDirect(e,"gs",{gamestate:this._gamestate,isLightweight:t});else{const{session:t,grimoire:s}=this._store.state,{fabled:i}=this._store.state.players;this.sendEdition(e),this._sendDirect(e,"gs",{gamestate:this._gamestate,isNight:s.isNight,isVoteHistoryAllowed:t.isVoteHistoryAllowed,nomination:t.nomination,votingSpeed:t.votingSpeed,lockedVote:t.lockedVote,isPlayFanfare:t.isPlayFanfare,isVoteInProgress:t.isVoteInProgress,markedPlayer:t.markedPlayer,fabled:i.map(e=>e.isCustom?e:{id:e.id}),...t.nomination?{votes:t.votes}:{}})}}_updateGamestate(e){if(!this._isSpectator)return;const{gamestate:t,isLightweight:s,isNight:i,isVoteHistoryAllowed:a,nomination:o,votingSpeed:r,votes:n,lockedVote:l,isPlayFanfare:c,isVoteInProgress:d,markedPlayer:m,fabled:h}=e,p=this._store.state.players.players;if(p.length<t.length)for(let g=p.length;g<t.length;g++)this._store.commit("players/add",t[g].name);else if(p.length>t.length)for(let g=p.length;g>t.length;g--)this._store.commit("players/remove",g-1);t.forEach((e,t)=>{const s=p[t],{roleId:i}=e;if(["name","id","isDead","isVoteless","pronouns"].forEach(t=>{const i=e[t];s[t]!==i&&this._store.commit("players/update",{player:s,property:t,value:i})}),i&&s.role.id!==i){const e=this._store.state.roles.get(i)||this._store.getters.rolesJSONbyId.get(i);e&&this._store.commit("players/update",{player:s,property:"role",value:e})}else i||"traveler"!==s.role.team||this._store.commit("players/update",{player:s,property:"role",value:{}})}),s||(this._store.commit("toggleNight",!!i),this._store.commit("session/setVoteHistoryAllowed",a),this._store.commit("session/setPlayFanfare",c),this._store.commit("session/nomination",{nomination:o,votes:n,votingSpeed:r,lockedVote:l,isVoteInProgress:d}),this._store.commit("session/setMarkedPlayer",m),this._store.commit("players/setFabled",{fabled:h.map(e=>this._store.state.fabled.get(e.id)||e)}))}sendEdition(e=""){if(this._isSpectator)return;const{edition:t}=this._store.state;let s;t.isOfficial||(s=this._store.getters.customRolesStripped),this._sendDirect(e,"edition",{edition:t.isOfficial?{id:t.id}:t,...s?{roles:s}:{}})}_updateEdition({edition:e,roles:t}){if(this._isSpectator&&(this._store.commit("setEdition",e),t&&(this._store.commit("setCustomRoles",t),this._store.state.roles.size!==t.length))){const e=[];t.forEach(({id:t})=>{this._store.state.roles.get(t)||e.push(t)}),alert("This session contains custom characters that can't be found. Please load them before joining! Missing roles: "+e.join(", ")),this.disconnect(),this._store.commit("toggleModal","edition")}}sendFabled(){if(this._isSpectator)return;const{fabled:e}=this._store.state.players;this._send("fabled",e.map(e=>e.isCustom?e:{id:e.id}))}_updateFabled(e){this._isSpectator&&this._store.commit("players/setFabled",{fabled:e.map(e=>this._store.state.fabled.get(e.id)||e)})}sendPlayer({player:e,property:t,value:s}){if(this._isSpectator||"reminders"===t)return;const i=this._store.state.players.players.indexOf(e);"role"===t?s.team&&"traveler"===s.team?(this._gamestate[i].roleId=s.id,this._send("player",{index:i,property:t,value:s.id})):this._gamestate[i].roleId&&(delete this._gamestate[i].roleId,this._send("player",{index:i,property:t,value:""})):this._send("player",{index:i,property:t,value:s})}_updatePlayer({index:e,property:t,value:s}){if(!this._isSpectator)return;const i=this._store.state.players.players[e];if(i)if("role"===t)if(s||"traveler"!==i.role.team){const e=this._store.state.roles.get(s)||this._store.getters.rolesJSONbyId.get(s)||{};this._store.commit("players/update",{player:i,property:"role",value:e})}else this._store.commit("players/update",{player:i,property:"role",value:{}});else this._store.commit("players/update",{player:i,property:t,value:s})}sendPlayerPronouns({player:e,value:t,isFromSockets:s}){if(s||this._isSpectator&&this._store.state.session.playerId!==e.id)return;const i=this._store.state.players.players.indexOf(e);this._send("pronouns",[i,t])}_updatePlayerPronouns([e,t]){const s=this._store.state.players.players[e];this._store.commit("players/update",{player:s,property:"pronouns",value:t,isFromSockets:!0})}_handlePing([e=0,t]=[]){const s=(new Date).getTime();if(this._isSpectator)t&&this._store.commit("session/setPing",parseInt(t,10));else{for(let e in this._players)s-this._players[e]>2*this._pingInterval&&(delete this._players[e],delete this._pings[e]);if(this._store.state.players.players.forEach(e=>{e.id&&!this._players[e.id]&&this._store.commit("players/update",{player:e,property:"id",value:""})}),e){this._players[e]=s;const i=parseInt(t,10);if(i&&i>0&&i<3e4){this._pings[e]=i;const t=Object.values(this._pings);this._store.commit("session/setPing",Math.round(t.reduce((e,t)=>e+t,0)/t.length))}}}this._isSpectator&&!e||this._store.commit("session/setPlayerCount",this._isSpectator?e:Object.keys(this._players).length)}_handleBye(e){this._isSpectator||(delete this._players[e],this._store.commit("session/setPlayerCount",Object.keys(this._players).length))}claimSeat(e){if(!this._isSpectator)return;const t=this._store.state.players.players;t.length>e&&(e<0||!t[e].id)&&this._send("claim",[e,this._store.state.session.playerId])}_updateSeat([e,t]){if(this._isSpectator)return;const s="id",i=this._store.state.players.players,a=i.findIndex(({id:e})=>e===t);if(a>=0&&a!==e&&this._store.commit("players/update",{player:i[a],property:s,value:""}),e>=0){const a=i[e];if(!a)return;this._store.commit("players/update",{player:a,property:s,value:t})}this._handlePing([!0,t,0])}distributeRoles(){if(this._isSpectator)return;const e={};this._store.state.players.players.forEach((t,s)=>{t.id&&t.role&&(e[t.id]=["player",{index:s,property:"role",value:t.role.id}])}),Object.keys(e).length&&this._send("direct",e)}nomination(e){if(this._isSpectator)return;const t=e&&e.nomination||e,s=this._store.state.players.players;(!t||s.length>t[0]&&s.length>t[1])&&(this.setVotingSpeed(this._store.state.session.votingSpeed),this._send("nomination",t))}setPlayFanfare(){this._isSpectator||this._send("isPlayFanfare",this._store.state.session.isPlayFanfare)}setVoteInProgress(){this._isSpectator||this._send("isVoteInProgress",this._store.state.session.isVoteInProgress)}setIsNight(){this._isSpectator||this._send("isNight",this._store.state.grimoire.isNight)}setVoteHistoryAllowed(){this._isSpectator||this._send("isVoteHistoryAllowed",this._store.state.session.isVoteHistoryAllowed)}setVotingSpeed(e){this._isSpectator||e&&this._send("votingSpeed",e)}setMarked(e){this._isSpectator||this._send("marked",e)}clearVoteHistory(){this._isSpectator||this._send("clearVoteHistory")}vote([e]){const t=this._store.state.players.players[e];this._store.state.session.playerId!==t.id&&this._isSpectator||this._send("vote",[e,this._store.state.session.votes[e],!this._isSpectator])}_handleVote([e,t,s]){const{session:i,players:a}=this._store.state,o=a.players.length,r=(e-1+o-i.nomination[1])%o;(s||r>=i.lockedVote-1)&&this._store.commit("session/vote",[e,t])}lockVote(){if(this._isSpectator)return;const{lockedVote:e,votes:t,nomination:s}=this._store.state.session,{players:i}=this._store.state.players,a=(s[1]+e-1)%i.length;this._send("lock",[this._store.state.session.lockedVote,t[a]])}_handleLock([e,t]){if(this._isSpectator&&(this._store.commit("session/lockVote",e),e>1)){const{lockedVote:e,nomination:s}=this._store.state.session,{players:i}=this._store.state.players,a=(s[1]+e-1)%i.length;this._store.state.session.votes[a]!==t&&this._store.commit("session/vote",[a,t])}}swapPlayer(e){this._isSpectator||this._send("swap",e)}movePlayer(e){this._isSpectator||this._send("move",e)}removePlayer(e){this._isSpectator||this._send("remove",e)}}var kt=e=>{const t=new bt(e);e.subscribe(({type:e,payload:s},i)=>{switch(e){case"session/setSessionId":i.session.sessionId?t.connect(i.session.sessionId):(window.location.hash="",t.disconnect());break;case"session/claimSeat":t.claimSeat(s);break;case"session/distributeRoles":s&&t.distributeRoles();break;case"session/setPlayFanfare":t.setPlayFanfare(s);break;case"session/nomination":case"session/setNomination":t.nomination(s);break;case"session/setVoteInProgress":t.setVoteInProgress(s);break;case"session/voteSync":t.vote(s);break;case"session/lockVote":t.lockVote();break;case"session/setVotingSpeed":t.setVotingSpeed(s);break;case"session/clearVoteHistory":t.clearVoteHistory();break;case"session/setVoteHistoryAllowed":t.setVoteHistoryAllowed();break;case"toggleNight":t.setIsNight();break;case"setEdition":t.sendEdition();break;case"players/setFabled":t.sendFabled();break;case"session/setMarkedPlayer":t.setMarked(s);break;case"players/swap":t.swapPlayer(s);break;case"players/move":t.movePlayer(s);break;case"players/remove":t.removePlayer(s);break;case"players/set":case"players/clear":case"players/add":t.sendGamestate("",!0);break;case"players/update":"pronouns"===s.property?t.sendPlayerPronouns(s):t.sendPlayer(s);break}});const s=window.location.hash.substr(1);s&&(e.commit("session/setSpectator",!0),e.commit("session/setSessionId",s),e.commit("toggleGrimoire",!1))};const _t={name:"",id:"",role:{},reminders:[],isVoteless:!1,isDead:!1,pronouns:""},St=()=>({players:[],fabled:[],bluffs:[]}),wt={alive({players:e}){return e.filter(e=>!e.isDead).length},nonTravelers({players:e}){const t=e.filter(e=>"traveler"!==e.role.team);return Math.min(t.length,15)},nightOrder({players:e,fabled:t}){const s=[0],i=[0];e.forEach(({role:e})=>{e.firstNight&&!s.includes(e.firstNight)&&s.push(e.firstNight),e.otherNight&&!i.includes(e.otherNight)&&i.push(e.otherNight)}),t.forEach(e=>{e.firstNight&&!s.includes(e.firstNight)&&s.push(e.firstNight),e.otherNight&&!i.includes(e.otherNight)&&i.push(e.otherNight)}),s.sort((e,t)=>e-t),i.sort((e,t)=>e-t);const a=new Map;return e.forEach(e=>{const t=Math.max(s.indexOf(e.role.firstNight),0),o=Math.max(i.indexOf(e.role.otherNight),0);a.set(e,{first:t,other:o})}),t.forEach(e=>{const t=Math.max(s.indexOf(e.firstNight),0),o=Math.max(i.indexOf(e.otherNight),0);a.set(e,{first:t,other:o})}),a}},Nt={randomize({state:e,commit:t}){const s=e.players.map(e=>[Math.random(),e]).sort((e,t)=>e[0]-t[0]).map(e=>e[1]);t("set",s)},clearRoles({state:e,commit:t,rootState:s}){let i;s.session.isSpectator?i=e.players.map(e=>("traveler"!==e.role.team&&(e.role={}),e.reminders=[],e)):(i=e.players.map(({name:e,id:t,pronouns:s})=>({..._t,name:e,id:t,pronouns:s})),t("setFabled",{fabled:[]})),t("set",i),t("setBluff")}},Ot={clear(e){e.players=[],e.bluffs=[],e.fabled=[]},set(e,t=[]){e.players=t},update(e,{player:t,property:s,value:i}){const a=e.players.indexOf(t);a>=0&&(e.players[a][s]=i)},add(e,t){e.players.push({..._t,name:t})},remove(e,t){e.players.splice(t,1)},swap(e,[t,s]){[e.players[t],e.players[s]]=[e.players[s],e.players[t]],e.players.splice(0,0)},move(e,[t,s]){e.players.splice(s,0,e.players.splice(t,1)[0])},setBluff(e,{index:t,role:s}={}){void 0!==t?e.bluffs.splice(t,1,s):e.bluffs=[]},setFabled(e,{index:t,fabled:s}={}){void 0!==t?e.fabled.splice(t,1):s&&(Array.isArray(s)?e.fabled=s:e.fabled.push(s))}};var It={namespaced:!0,state:St,getters:wt,actions:Nt,mutations:Ot};const Mt=(e,[t,s])=>{e.nomination&&(e.votes=[...e.votes],e.votes[t]=void 0===s?!e.votes[t]:s)},Ct=()=>({sessionId:"",isSpectator:!1,isReconnecting:!1,playerCount:0,ping:0,playerId:"",claimedSeat:-1,nomination:!1,votes:[],lockedVote:0,votingSpeed:3e3,isPlayFanfare:!1,isVoteInProgress:!1,voteHistory:[],markedPlayer:-1,isVoteHistoryAllowed:!0,isRolesDistributed:!1}),Rt={},xt={},Pt=e=>(t,s)=>{t[e]=s},jt={setPlayerId:Pt("playerId"),setSpectator:Pt("isSpectator"),setReconnecting:Pt("isReconnecting"),setPlayerCount:Pt("playerCount"),setPing:Pt("ping"),setVotingSpeed:Pt("votingSpeed"),setPlayFanfare:Pt("isPlayFanfare"),setVoteInProgress:Pt("isVoteInProgress"),setMarkedPlayer:Pt("markedPlayer"),setNomination:Pt("nomination"),setVoteHistoryAllowed:Pt("isVoteHistoryAllowed"),claimSeat:Pt("claimedSeat"),distributeRoles:Pt("isRolesDistributed"),setSessionId(e,t){e.sessionId=t.toLocaleLowerCase().replace(/[^0-9a-z]/g,"").substr(0,10)},nomination(e,{nomination:t,votes:s,votingSpeed:i,lockedVote:a,isVoteInProgress:o}={}){e.nomination=t||!1,e.votes=s||[],e.votingSpeed=i||e.votingSpeed,e.lockedVote=a||0,e.isVoteInProgress=o||!1},addHistory(e,t){if(!e.isVoteHistoryAllowed&&e.isSpectator)return;if(!e.nomination||e.lockedVote<=t.length)return;const s="traveler"===t[e.nomination[1]].role.team;e.voteHistory.push({timestamp:new Date,nominator:t[e.nomination[0]].name,nominee:t[e.nomination[1]].name,type:s?"Landsförvisning":"Utkastning",majority:Math.ceil(t.filter(e=>!e.isDead||s).length/2),votes:t.filter((t,s)=>e.votes[s]).map(({name:e})=>e)})},clearVoteHistory(e){e.voteHistory=[]},vote:Mt,voteSync:Mt,lockVote(e,t){e.lockedVote=void 0!==t?t:e.lockedVote+1}};var Vt={namespaced:!0,state:Ct,getters:Rt,actions:xt,mutations:jt},Tt=s("b1d9"),$t=s("b249"),Ht=s("c825");i["a"].use(r["a"]);const Ft=(e=ge[0])=>new Map(Tt.filter(t=>t.edition===e.id||e.roles.includes(t.id)).sort((e,t)=>t.team.localeCompare(e.team)).map(e=>[e.id,e])),Dt=(e=ge[0])=>new Map(Tt.filter(t=>"traveler"===t.team&&t.edition!==e.id&&!e.roles.includes(t.id)).map(e=>[e.id,e])),Et=e=>({grimoire:t},s)=>{t[e]=s},Lt=e=>({grimoire:t},s)=>{t[e]=!0===s||!1===s?s:!t[e]},Gt=e=>e.toLocaleLowerCase().replace(/[^a-z0-9]/g,""),At=new Map(ge.map(e=>[e.id,e])),Bt=new Map(Tt.map(e=>[e.id,e])),zt=new Map($t.map(e=>[e.id,e]));let Jt={};try{Jt=new Map(Ht.map(({id:e,hatred:t})=>[Gt(e),new Map(t.map(({id:e,reason:t})=>[Gt(e),t]))]))}catch(es){console.error("couldn't load jinxes",es)}const Ut={id:"",name:"",image:"",ability:"",edition:"custom",firstNight:0,firstNightReminder:"",otherNight:0,otherNightReminder:"",reminders:[],remindersGlobal:[],setup:!1,team:"townsfolk",isCustom:!0};var qt=new r["a"].Store({modules:{players:It,session:Vt},state:{grimoire:{isNight:!1,isNightOrder:!0,isPublic:!0,isMenuOpen:!1,isStatic:!1,isMuted:!1,isImageOptIn:!1,zoom:0,background:""},modals:{edition:!1,fabled:!1,gameState:!1,nightOrder:!1,reference:!1,reminder:!1,role:!1,roles:!1,voteHistory:!1},edition:At.get("tb"),roles:Ft(),otherTravelers:Dt(),fabled:zt,jinxes:Jt},getters:{customRolesStripped:({roles:e})=>{const t=[],s=Object.keys(Ut),i=["firstNightReminder","otherNightReminder","isCustom"];return e.forEach(e=>{if(e.isCustom){const a={};for(let t in e){if(i.includes(t))continue;const o=e[t];s.includes(t)&&o!==Ut[t]&&(a[s.indexOf(t)]=o)}t.push(a)}else t.push({id:e.id})}),t},rolesJSONbyId:()=>Bt},mutations:{setZoom:Et("zoom"),setBackground:Et("background"),toggleMuted:Lt("isMuted"),toggleMenu:Lt("isMenuOpen"),toggleNightOrder:Lt("isNightOrder"),toggleStatic:Lt("isStatic"),toggleNight:Lt("isNight"),toggleGrimoire:Lt("isPublic"),toggleImageOptIn:Lt("isImageOptIn"),toggleModal({modals:e},t){t&&(e[t]=!e[t]);for(let s in e)s!==t&&(e[s]=!1)},setCustomRoles(e,t){const s=t.map(e=>{if(e[0]){const t=Object.keys(Ut),s={};for(let i in e)t[i]&&(s[t[i]]=e[i]);return s}return e}).map(e=>(e.id=Gt(e.id),e)).map(t=>Bt.get(t.id)||e.roles.get(t.id)||Object.assign({},Ut,t)).map(e=>(Bt.get(e.id)||(e.imageAlt={townsfolk:"good",outsider:"outsider",minion:"minion",demon:"evil",fabled:"fabled"}[e.team]||"custom",e.firstNight=Math.abs(e.firstNight),e.otherNight=Math.abs(e.otherNight)),e)).filter(e=>e.name&&e.ability&&e.team).sort((e,t)=>t.team.localeCompare(e.team));e.roles=new Map(s.filter(e=>"fabled"!==e.team).map(e=>[e.id,e])),e.fabled=new Map([...s.filter(e=>"fabled"===e.team).map(e=>[e.id,e]),...$t.map(e=>[e.id,e])]),e.otherTravelers=new Map(Tt.filter(e=>"traveler"===e.team&&!t.some(t=>t.id===e.id)).map(e=>[e.id,e]))},setEdition(e,t){At.has(t.id)?(e.edition=At.get(t.id),e.roles=Ft(e.edition),e.otherTravelers=Dt(e.edition)):e.edition=t,e.modals.edition=!1}},plugins:[yt.a,kt]}),Kt=s("ecee"),Wt=s("c074"),Zt=s("f2d1"),Qt=s("ad3d");const Yt=["AddressCard","BookOpen","BookDead","BroadcastTower","Chair","CheckSquare","ChessRook","CloudMoon","Cog","Copy","Clipboard","Crown","Dice","Dragon","ExchangeAlt","ExclamationTriangle","FileCode","FileUpload","HandPaper","HandPointRight","Heartbeat","Image","Link","MinusCircle","PeopleArrows","PlusCircle","Question","Random","RedoAlt","SearchMinus","SearchPlus","Square","TheaterMasks","Times","TimesCircle","TrashAlt","Undo","User","UserEdit","UserFriends","Users","VenusMars","VolumeUp","VolumeMute","VoteYea","WindowMaximize","WindowMinimize"],Xt=["Github","Discord"];Kt["c"].add(...Yt.map(e=>Wt["a"]["fa"+e]),...Xt.map(e=>Zt["a"]["fa"+e])),i["a"].component("font-awesome-icon",Qt["a"]),i["a"].config.productionTip=!1,new i["a"]({render:e=>e(ft),store:qt}).$mount("#app")},5768:function(e,t,s){"use strict";s("8613")},"589c":function(e,t,s){"use strict";s("f32e")},"5f4e":function(e,t,s){e.exports=s.p+"img/tb-minion.02954ab4.png"},"61b0":function(e,t){function s(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}s.keys=function(){return[]},s.resolve=s,e.exports=s,s.id="61b0"},"634a":function(e){e.exports=JSON.parse('[{"townsfolk":3,"outsider":0,"minion":1,"demon":1},{"townsfolk":3,"outsider":1,"minion":1,"demon":1},{"townsfolk":5,"outsider":0,"minion":1,"demon":1},{"townsfolk":5,"outsider":1,"minion":1,"demon":1},{"townsfolk":5,"outsider":2,"minion":1,"demon":1},{"townsfolk":7,"outsider":0,"minion":2,"demon":1},{"townsfolk":7,"outsider":1,"minion":2,"demon":1},{"townsfolk":7,"outsider":2,"minion":2,"demon":1},{"townsfolk":9,"outsider":0,"minion":3,"demon":1},{"townsfolk":9,"outsider":1,"minion":3,"demon":1},{"townsfolk":9,"outsider":2,"minion":3,"demon":1}]')},"63b1":function(e,t,s){e.exports=s.p+"img/scribe.7b0c62e4.svg"},6651:function(e,t,s){e.exports=s.p+"img/steward.134a26d6.svg"},"68e4":function(e,t,s){"use strict";s("47c2")},"690b":function(e,t,s){"use strict";s("4aa7")},"69e2":function(e,t,s){},"6b42":function(e,t,s){e.exports=s.p+"img/knight.1f88aba6.svg"},"6f31":function(e,t,s){e.exports=s.p+"img/child.b136eae8.svg"},"6f32":function(e,t,s){var i={"./apothecary.svg":"26c8","./armor.svg":"da17","./beggar.svg":"c501","./bureaucrat.svg":"faa9","./butler.svg":"f1fc","./chancellor.svg":"9a81","./child.svg":"6f31","./clerkofthewardrobe.svg":"b48e","./constable.svg":"c13b","./cupbearer.svg":"076f","./custom.svg":"3d0b","./duel.svg":"44b5","./duke.svg":"0ff5","./evil.svg":"56b6","./good.svg":"0265","./headlibrarian.svg":"ab90","./herald.svg":"d2e3","./knight.svg":"6b42","./lordchamberlain.svg":"ca1b","./lordsrepresentative.svg":"25ee","./marshal.svg":"fc07","./minion.svg":"14d9","./mute.svg":"11df","./outsider.svg":"34af","./plaguedoctor.svg":"82bc","./plus.svg":"eb38","./poisoner.svg":"8892","./prince.svg":"f85e","./recluse.svg":"8baa","./revolutionary.svg":"c0d5","./scapegoat.svg":"de22","./scribe.svg":"63b1","./seneschal.svg":"e64a","./spy.svg":"046f","./steward.svg":"6651","./thief.svg":"c632","./toymaker.svg":"8290","./treasurer.svg":"3a48","./vigilante.svg":"5674","./villageidiot.svg":"c966","./x.svg":"7387"};function a(e){var t=o(e);return s(t)}function o(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}a.keys=function(){return Object.keys(i)},a.resolve=o,e.exports=a,a.id="6f32"},"703f":function(e,t,s){},"72f7":function(e,t,s){e.exports=s.p+"img/tb-usurper.7a6c32e0.png"},7387:function(e,t,s){e.exports=s.p+"img/x.c9609740.svg"},"73a1":function(e,t,s){e.exports=s.p+"img/tb-outsider.897bea55.png"},7496:function(e,t,s){e.exports=s.p+"img/bmr.1d06ca78.png"},"7b7c":function(e,t,s){},"7ff7":function(e,t,s){e.exports=s.p+"media/trumpet-royal-fanfare.3f610008.mp3"},8290:function(e,t,s){e.exports=s.p+"img/toymaker.745f631f.svg"},"82bc":function(e,t,s){e.exports=s.p+"img/plaguedoctor.8fb69b67.svg"},"83ea":function(e,t,s){},8613:function(e,t,s){},8892:function(e,t,s){e.exports=s.p+"img/poisoner.e552ef1c.svg"},"8baa":function(e,t,s){e.exports=s.p+"img/recluse.bc4aec11.svg"},9224:function(e){e.exports=JSON.parse('{"a":"0.1.0"}')},"92d8":function(e,t,s){e.exports=s.p+"img/luf.8e16a6e6.png"},9426:function(e,t,s){e.exports=s.p+"img/sitt-logo.08566e32.svg"},9479:function(e,t,s){e.exports=s.p+"img/tb-household.897bea55.png"},"9a81":function(e,t,s){e.exports=s.p+"img/chancellor.38621ae0.svg"},"9aaf":function(e,t,s){},a3b0:function(e,t,s){e.exports=s.p+"img/tb-demon.7a6c32e0.png"},ab90:function(e,t,s){e.exports=s.p+"img/headlibrarian.b869aa3b.svg"},aecf:function(e,t,s){"use strict";s("1821")},b13a:function(e,t,s){},b1d9:function(e){e.exports=JSON.parse('[{"id":"apothecary","name":"Apotekare","edition":"tb","team":"townsfolk","firstNight":0,"firstNightReminder":"","otherNight":13,"otherNightReminder":"Den tidigare skyddade spelaren är inte längre skyddad. Apotekaren pekar på en spelare (inte sig själv). Markera den spelaren som \'Skyddad\'.","reminders":["Skyddad"],"setup":false,"ability":"Varje natt väljer du en spelare (inte dig själv): den är säker från Troninkräktaren inatt."},{"id":"steward","name":"Förvaltare","edition":"tb","team":"townsfolk","firstNight":34,"firstNightReminder":"Visa karaktärssymbolen för en Hantlangare i spel. Peka på två spelare, varav en är den karaktären.","otherNight":0,"otherNightReminder":"","reminders":["Hantlangare","Fel"],"setup":false,"ability":"Du börjar spelet med informationen att 1 av 2 spelare är en viss Hantlangare."},{"id":"lordchamberlain","name":"Hovmarskalk","edition":"tb","team":"townsfolk","firstNight":36,"firstNightReminder":"Visa fingersignalen (0, 1, 2) för antalet fria grannar till Hovmarskalk som är Inkräktare.","otherNight":53,"otherNightReminder":"Visa fingersignalen (0, 1, 2) för antalet fria grannar till Hovmarskalk som är Inkräktare.","reminders":[],"setup":false,"ability":"Varje natt får du reda på hur många av dina 2 grannar, som är kvar i hovet, som tillhör Inkräktarna."},{"id":"herald","name":"Härold","edition":"tb","team":"townsfolk","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":["Ingen förmåga"],"setup":false,"ability":"En gång per spel, under dagen, välj en spelare offentligt: om de är Troninkräktaren kastas de ut från hovet."},{"id":"clerkofthewardrobe","name":"Kammarmästare","edition":"tb","team":"townsfolk","firstNight":32,"firstNightReminder":"Visa karaktärsmarkören för ett Hovfolk i spel. Peka på två spelare, varav en är den karaktären.","otherNight":0,"otherNightReminder":"","reminders":["Hovfolk","Fel"],"setup":false,"ability":"Du börjar spelet med informationen att 1 av 2 spelare är ett visst Hovfolk."},{"id":"chancellor","name":"Kansler","edition":"tb","team":"townsfolk","firstNight":37,"firstNightReminder":"Kanslern pekar på två spelare. Ge huvudsignalen (nicka ja, skaka nej) för om en av dessa spelare är Troninkräktaren.","otherNight":54,"otherNightReminder":"Kanslern pekar på två spelare. Ge huvudsignalen (nicka ja, skaka nej) för om en av dessa spelare är Troninkräktaren.","reminders":["Villospår"],"setup":false,"ability":"Varje natt väljer du 2 spelare: du får reda på om en av de är Troninkräktaren. Det finns en av Hovfolket som registreras som Troninkräktaren för dig."},{"id":"constable","name":"Konstapel","edition":"tb","team":"townsfolk","firstNight":0,"firstNightReminder":"","otherNight":56,"otherNightReminder":"Om en spelare blev utkastad idag: Visa den spelarens karaktärmarkör.","reminders":["Imprisoned"],"setup":false,"ability":"Varje natt får du veta vilken karaktär som kastades ut ur hovet idag."},{"id":"marshal","name":"Marskalk","edition":"tb","team":"townsfolk","firstNight":0,"firstNightReminder":"","otherNight":42,"otherNightReminder":"Om Marskalken förvisades i natt: Marskalken pekar på en spelare. Visa spelarens karaktärsmarkör.","reminders":[],"setup":false,"ability":"Om du förvisades under natten, blir du väckt för att välja en spelare: du får veta dess karaktär."},{"id":"cupbearer","name":"Munskänk","edition":"tb","team":"townsfolk","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":["Ingen förmåga"],"setup":false,"ability":"Första gången du blir nominerad, om den som nominerade dig är Hovfolk kastas de direkt ut ur hovet."},{"id":"prince","name":"Prins","edition":"tb","team":"townsfolk","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"ability":"Om bara tre spelare är kvar i hovet och ingen blir utkastad, så vinner ditt lag. Om du blir förvisad under natten så kan en annan spelare bli förvisad istället."},{"id":"seneschal","name":"Seneskalk","edition":"tb","team":"townsfolk","firstNight":33,"firstNightReminder":"Visa karaktärssymbolen för en Hushålls karaktär i spel. Peka på två spelare, varav en är den karaktären.","otherNight":0,"otherNightReminder":"","reminders":["Hushållet","Fel"],"setup":false,"ability":"Du börjar spelet med information att 1 av 2 spelare är en viss del av Hushållet. (Eller att ingen är i spel)."},{"id":"treasurer","name":"Skattmästare","edition":"tb","team":"townsfolk","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"ability":"Du är skyddad från Troninkräktaren."},{"id":"scribe","name":"Skrivare","edition":"tb","team":"townsfolk","firstNight":35,"firstNightReminder":"Visa fingersignal (0, 1, 2, …) för antalet par av inkräktare som sitter bredvid varandra.","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"ability":"Vid spelets start får du reda på hur många par av inkräktare spelet har."},{"id":"child","name":"Barn","edition":"tb","team":"outsider","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"ability":"Om du blir utkastad under dagen förlorar ditt lag."},{"id":"villageidiot","name":"Byfåne","edition":"tb","team":"outsider","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"remindersGlobal":["Byfåne"],"setup":true,"ability":"Du vet inte att du är Byfånen. Du tror att du är en av Hovfolket, men det är du inte utan du är förvirrad."},{"id":"recluse","name":"Eremit","edition":"tb","team":"outsider","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"ability":"Du kan registrera som en Inkräktare & som en Hantlangare eller Troninkräktare, även om du inte är kvar i hovet."},{"id":"butler","name":"Förste betjänt","edition":"tb","team":"outsider","firstNight":38,"firstNightReminder":"Förste betjänten pekar på en spelare. Markera den spelaren som \'Mästare\'.","otherNight":55,"otherNightReminder":"Förste betjänten pekar på en spelare. Markera den spelaren som \'Mästare\'.","reminders":["Mästare"],"setup":false,"ability":"Varje natt väljer du en spelare (inte dig själv): imorgon får du endast rösta om de också röstar."},{"id":"poisoner","name":"Förgiftare","edition":"tb","team":"minion","firstNight":17,"firstNightReminder":"Förgiftaren pekar på en spelare. Den spelaren är förgiftad.","otherNight":8,"otherNightReminder":"Den tidigare förgiftade spelaren är inte längre förgiftad. Förgiftaren pekar på en spelare. Den spelaren är nu förgiftad.","reminders":["Förgiftad"],"setup":false,"ability":"Varje natt väljer du en spelare: de är förgiftad inatt och under morgondagen."},{"id":"lordsrepresentative","name":"Hertigens rep.","edition":"tb","team":"minion","firstNight":0,"firstNightReminder":"","otherNight":20,"otherNightReminder":"Om Hertigens representant blev Troninkräktaren idag: Visa \'Du är\'-kortet, efter det \'Troninkräktaren\'.","reminders":["Troninkräktare"],"setup":false,"ability":"Om det finns 5 eller fler spelare i hovet och Troninkräktaren tas bort från hovet blir du Troninkräktaren. (Gäster räknas inte)"},{"id":"knight","name":"Riddare","edition":"tb","team":"minion","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":true,"ability":"Det är 2 extra i Hushållet detta spel. [+2 Hushållet]"},{"id":"spy","name":"Spion","edition":"tb","team":"minion","firstNight":48,"firstNightReminder":"Visa de Kungliga Hemligheternas Bok för Spionen så länge de behöver.","otherNight":68,"otherNightReminder":"Visa de Kungliga Hemligheternas Bok för Spionen så länge de behöver.","reminders":[],"setup":false,"ability":"Varje natt ser du de Kungliga Hemligheternas Bok. Du kan registrera som en Lojal & som Hovfolk eller Hushållet, även om du inte är i hovet längre."},{"id":"duke","name":"Hertig","edition":"tb","team":"demon","firstNight":0,"firstNightReminder":"","otherNight":24,"otherNightReminder":"Hertigen pekar på en spelare. Den spelaren förvisas. Om Hertigen valde sig själva: Byt ut karaktären av 1 hantlangare fortfarande i hovet med en extra Hertigmarkör. Visa den nya Hertigen \'Du är\'-kortet och sedan Hertigmarkören.","reminders":["Förvisad"],"setup":false,"ability":"Varje natt väljer du en spelare: de förvisas från hovet. Om du förvisar dig själv så blir en Hantlangare den nye Troninkräktaren."},{"id":"bureaucrat","name":"Byråkrat","edition":"tb","team":"traveler","firstNight":1,"firstNightReminder":"Byråkraten pekar på en spelare. Lägg byråkratens \'3 röster\'-påminnelse vid den valda spelarens karaktärsmarkör.","otherNight":1,"otherNightReminder":"Byråkraten pekar på en spelare. Lägg byråkratens \'3 röster\'-påminnelse vid den valda spelarens karaktärssymbol.","reminders":["3 röster"],"setup":false,"ability":"Varje natt väljer du en spelare (inte dig själv): deras röst räknas som 3 röster under morgondagen."},{"id":"vigilante","name":"Medborgargarde","edition":"tb","team":"traveler","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"ability":"Varje dag efter att första röstningen räknats kan du välja en spelare som röstade, de kastas direkt ut ur hovet."},{"id":"scapegoat","name":"Syndabock","edition":"tb","team":"traveler","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"ability":"Om en spelare i ditt lag kastas ut kan du kastas ut istället."},{"id":"beggar","name":"Tiggare","edition":"tb","team":"traveler","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"ability":"Du måste använda en röstmarkör för att rösta. Om spelare som inte är kvar i hovet ger deras markör får du reda på deras lag. Du är inte förvirrad eller förgiftad."},{"id":"thief","name":"Tjuv","edition":"tb","team":"traveler","firstNight":1,"firstNightReminder":"Tjuven pekar på en spelare. Lägg tjuvens påminnelse om \'Negativ röst\' vid den valda spelarens karaktärsmarkör.","otherNight":1,"otherNightReminder":"Tjuven pekar på en spelare. Lägg tjuvens påminnelse om \'Negativ röst\' vid den valda spelarens karaktärsmarkör.","reminders":["Negative röst"],"setup":false,"ability":"Varje natt väljer du en spelare (inte dig själv): deras röst räknas negativt imorgon."}]')},b249:function(e){e.exports=JSON.parse('[{"id":"plaguedoctor","firstNightReminder":"","otherNightReminder":"","reminders":[],"setup":false,"name":"Pestläkare","team":"fabled","ability":"Om 4 eller fler spelare är kvar i hovet kan var och en av dessa (en gång per spel) offentligt välja att en spelare av deras lag skall kastas ut."},{"id":"armor","firstNightReminder":"","otherNightReminder":"","reminders":["Skydda","Något Dåligt"],"setup":false,"name":"Rustning","team":"fabled","ability":"Något dåligt kan hända vemhelst som är mest ansvarig för att en ny spelare får lämna hovet."},{"id":"mute","firstNightReminder":"","otherNightReminder":"","reminders":[],"setup":false,"name":"Stum","team":"fabled","ability":"Under varje dags första 2 minuter får erfarna spelare inte prata."},{"id":"headlibrarian","firstNightReminder":"","otherNightReminder":"","reminders":["Något Dåligt"],"setup":false,"name":"Huvudbibliotekarie","team":"fabled","ability":"Något dåligt kan hända vemhelst som pratat medans Berättaren har bett om tystnad."},{"id":"revolutionary","firstNightReminder":"","otherNightReminder":"","reminders":["Använd"],"setup":false,"name":"Revolutionär","team":"fabled","ability":"2 grannar är kända för att vara i samma lag. En gång per spel kan 1 av den registrera fel."},{"id":"duel","firstNightReminder":"","otherNightReminder":"","reminders":[],"setup":false,"name":"Duel","team":"fabled","ability":"En gång per spel så får Troninkräktaren i hemlighet välja en Lojal spelare: alla spelare väljer sedan vilken av dessa 2 spelare som vinner, tillsammans med deras lag."},{"id":"toymaker","firstNightReminder":"","otherNight":1,"otherNightReminder":"Om det är en natt då en förvisning kan avsluta spelet, och Troninkräktaren är markerad med \'Sista Natten: Ingen Förvisning\', så agerar inte Troninkräktaren i natt. (Väck dem inte.)","reminders":["Sista Natten: Ingen Förvisning"],"setup":false,"name":"Leksaksmakare","team":"fabled","ability":"Troninkräktaren kan välja att inte förvisa & måste göra detta minst en gång per spel. Inkräktare får normal information vid start."}]')},b48e:function(e,t,s){e.exports=s.p+"img/clerkofthewardrobe.6f1ac1b0.svg"},c0d5:function(e,t,s){e.exports=s.p+"img/revolutionary.a482cd5e.svg"},c13b:function(e,t,s){e.exports=s.p+"img/constable.21746d7b.svg"},c501:function(e,t,s){e.exports=s.p+"img/beggar.73ca8ac9.svg"},c632:function(e,t,s){e.exports=s.p+"img/thief.35b89a2e.svg"},c825:function(e){e.exports=JSON.parse('[{"id":"Chambermaid","hatred":[{"id":"Mathematician","reason":"The Chambermaid learns if the Mathematician wakes tonight or not, even though the Chambermaid wakes first."}]},{"id":"Butler","hatred":[{"id":"Cannibal","reason":"If the Cannibal gains the Butler ability, the Cannibal learns this."}]},{"id":"Lunatic","hatred":[{"id":"Mathematician","reason":"The Mathematician learns if the Lunatic attacks a different player(s) than the real Demon attacked."}]},{"id":"Pit-Hag","hatred":[{"id":"Heretic","reason":"A Pit-Hag can not create a Heretic. "},{"id":"Damsel","reason":"If a Pit-Hag creates a Damsel, the Storyteller chooses which player it is."},{"id":"Politician","reason":"A Pit-hag can not create an evil Politician."}]},{"id":"Cerenovus","hatred":[{"id":"Goblin","reason":"The Cerenovus may choose to make a player mad that they are the Goblin."}]},{"id":"Leviathan","hatred":[{"id":"Soldier","reason":"If Leviathan nominates and executes the Soldier, the Soldier does not die."},{"id":"Monk","reason":"If Leviathan nominates and executes the player the Monk chose, that player does not die."},{"id":"Innkeeper","reason":"If Leviathan nominates and executes a player the Innkeeper chose, that player does not die."},{"id":"Ravenkeeper","reason":"If Leviathan is in play & the Ravenkeeper dies by execution, they wake that night to use their ability."},{"id":"Sage","reason":"If Leviathan is in play & the Sage dies by execution, they wake that night to use their ability."},{"id":"Farmer","reason":"If Leviathan is in play & a Farmer dies by execution, a good player becomes a Farmer that night."},{"id":"Mayor","reason":"If Leviathan is in play & no execution occurs on day 5, good wins."}]},{"id":"Al-Hadikhia","hatred":[{"id":"Scarlet Woman","reason":"If there are two living Al-Hadikhias, the Scarlet Woman Al-Hadikhia becomes the Scarlet Woman again."},{"id":"Mastermind","reason":"Only 1 jinxed character can be in play. Evil players start knowing which player and character it is."}]},{"id":"Lil\' Monsta","hatred":[{"id":"Poppy Grower","reason":"If the Poppy Grower is in play, Minions don\'t wake together. They are woken one by one, until one of them chooses to take the Lil\' Monsta token."},{"id":"Magician","reason":"Only 1 jinxed character can be in play. "},{"id":"Scarlet Woman","reason":"If there are 5 or more players alive and the player holding the Lil\' Monsta token dies, the Scarlet Woman is given the Lil\' Monsta token tonight."}]},{"id":"Lycanthrope","hatred":[{"id":"Gambler","reason":"If the Lycanthrope is alive and the Gambler kills themself at night, no other players can die tonight."}]},{"id":"Legion","hatred":[{"id":"Engineer","reason":"Legion and the Engineer can not both be in play at the start of the game. If the Engineer creates Legion, most players (including all evil players) become evil Legion."},{"id":"Preacher","reason":"Only 1 jinxed character can be in play."}]},{"id":"Fang Gu","hatred":[{"id":"Scarlet Woman","reason":"If the Fang Gu chooses an Outsider and dies, the Scarlet Woman does not become the Fang Gu."}]},{"id":"Spy","hatred":[{"id":"Magician","reason":"When the Spy sees the Grimoire, the Demon and Magician\'s character tokens are removed."},{"id":"Alchemist","reason":"The Alchemist can not have the Spy ability."},{"id":"Poppy Grower","reason":"If the Poppy Grower is in play, the Spy does not see the Grimoire until the Poppy Grower dies."},{"id":"Damsel","reason":"Only 1 jinxed character can be in play. "},{"id":"Heretic","reason":"Only 1 jinxed character can be in play."}]},{"id":"Widow","hatred":[{"id":"Magician","reason":"When the Widow sees the Grimoire, the Demon and Magician\'s character tokens are removed."},{"id":"Poppy Grower","reason":"If the Poppy Grower is in play, the Widow does not see the Grimoire until the Poppy Grower dies."},{"id":"Alchemist","reason":"The Alchemist can not have the Widow ability."},{"id":"Damsel","reason":"Only 1 jinxed character can be in play."},{"id":"Heretic","reason":"Only 1 jinxed character can be in play."}]},{"id":"Godfather","hatred":[{"id":"Heretic","reason":"Only 1 jinxed character can be in play."}]},{"id":"Marionette","hatred":[{"id":"Lil\' Monsta","reason":"The Marionette neighbors a Minion, not the Demon. The Marionette is not woken to choose who takes the Lil\' Monsta token."},{"id":"Poppy Grower","reason":"When the Poppy Grower dies, the Demon learns the Marionette but the Marionette learns nothing."},{"id":"Snitch","reason":"The Marionette does not learn 3 not in-play characters. The Demon learns an extra 3 instead."},{"id":"Balloonist","reason":"If the Marionette thinks that they are the Balloonist, +1 Outsider was added."},{"id":"Damsel","reason":"The Marionette does not learn that a Damsel is in play."},{"id":"Huntsman","reason":"If the Marionette thinks that they are the Huntsman, the Damsel was added."}]},{"id":"Riot","hatred":[{"id":"Engineer","reason":"Riot and the Engineer can not both be in play at the start of the game. \\nIf the Engineer creates Riot, the evil players become Riot."},{"id":"Golem","reason":"If The Golem nominates Riot, the Riot player does not die."},{"id":"Snitch","reason":"If the Snitch is in play, each Riot player gets an extra 3 bluffs."},{"id":"Saint","reason":"If a good player nominates and kills the Saint, the Saint\'s team loses."},{"id":"Butler","reason":"The Butler can not nominate their master."},{"id":"Pit-Hag","reason":"If the Pit-Hag creates Riot, all evil players become Riot. \\nIf the Pit-Hag creates Riot after day 3, the game continues for one more day."},{"id":"Mayor","reason":"If the 3rd day begins with just three players alive, the players may choose (as a group) not to nominate at all. If so (and a Mayor is alive) then the Mayor\'s team wins."},{"id":"Monk","reason":"If a Riot player nominates and kills the Monk-protected-player, the Monk-protected-player does not die."},{"id":"Farmer","reason":"If a Riot player nominates and kills a Farmer, the Farmer uses their ability tonight."},{"id":"Innkeeper","reason":"If a Riot player nominates an Innkeeper-protected-player, the Innkeeper-protected-player does not die."},{"id":"Sage","reason":"If a Riot player nominates and kills a Sage, the Sage uses their ability tonight."},{"id":"Ravenkeeper","reason":"If a Riot player nominates and kills the Ravenkeeper, the Ravenkeeper uses their ability tonight."},{"id":"Soldier","reason":"If a Riot player nominates the Soldier, the Soldier does not die."},{"id":"Grandmother","reason":"If a Riot player nominates and kills the Grandchild, the Grandmother dies too."},{"id":"King","reason":"If a Riot player nominates and kills the King and the Choirboy is alive, the Choirboy uses their ability tonight."},{"id":"Exorcist","reason":"Only 1 jinxed character can be in play."},{"id":"Minstrel","reason":"Only 1 jinxed character can be in play."},{"id":"Flowergirl","reason":"Only 1 jinxed character can be in play."},{"id":"Undertaker","reason":"Players that die by nomination register as being executed to the Undertaker."},{"id":"Cannibal","reason":"Players that die by nomination register as being executed to the Cannibal."},{"id":"Pacifist","reason":"Players that die by nomination register as being executed to the Pacifist."},{"id":"Devil\'s Advocate","reason":"Players that die by nomination register as being executed to the Devil\'s Advocate."},{"id":"Investigator","reason":"Riot registers as a Minion to the Investigator."},{"id":"Clockmaker","reason":"Riot registers as a Minion to the Clockmaker."},{"id":"Town Crier","reason":"Riot registers as a Minion to the Town Crier."},{"id":"Damsel","reason":"Riot registers as a Minion to the Damsel."},{"id":"Preacher","reason":"Riot registers as a Minion to the Preacher."}]},{"id":"Lleech","hatred":[{"id":"Mastermind","reason":"If the Mastermind is alive and the Lleech\'s host dies by execution, the Lleech lives but loses their ability. "},{"id":"Slayer","reason":"If the Slayer slays the Lleech\'s host, the host dies. "}]}]')},c859:function(e,t,s){},c966:function(e,t,s){e.exports=s.p+"img/villageidiot.e88bff47.svg"},ca1b:function(e,t,s){e.exports=s.p+"img/lordchamberlain.53554f2f.svg"},cae1:function(e,t,s){e.exports=s.p+"img/bmr-demon.75dfa056.png"},ce15:function(e,t,s){"use strict";s("5421")},ce23:function(e,t,s){var i={"./bmr-demon.png":"cae1","./bmr-minion.png":"28bf","./bmr-outsider.png":"e898","./bmr-townsfolk.png":"e988","./bmr.png":"7496","./custom.png":"441d","./luf.png":"92d8","./snv-demon.png":"f347","./snv-minion.png":"451a","./snv-outsider.png":"4dd9","./snv-townsfolk.png":"ed00","./snv.png":"2fd0","./tb-courtofficial.png":"d37f","./tb-demon.png":"a3b0","./tb-household.png":"9479","./tb-minion.png":"5f4e","./tb-outsider.png":"73a1","./tb-townsfolk.png":"f7a3","./tb-usurper.png":"72f7","./tb.png":"0aaa"};function a(e){var t=o(e);return s(t)}function o(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}a.keys=function(){return Object.keys(i)},a.resolve=o,e.exports=a,a.id="ce23"},d2e3:function(e,t,s){e.exports=s.p+"img/herald.61741b0f.svg"},d37f:function(e,t,s){e.exports=s.p+"img/tb-courtofficial.d9cbf2e9.png"},d5ff:function(e,t,s){"use strict";s("e5ee")},d7b3:function(e,t,s){},da17:function(e,t,s){e.exports=s.p+"img/armor.0c6a3d62.svg"},dd41:function(e,t,s){e.exports=s.p+"img/gstone.c4d4dc84.png"},de22:function(e,t,s){e.exports=s.p+"img/scapegoat.fc700919.svg"},dfb1:function(e,t){e.exports=e=>{const t=e=>document.title="Struggle in the Tower "+(e?"Tronsal":"Kungliga Hemligheternas Bok");if(localStorage.getItem("background")&&e.commit("setBackground",localStorage.background),localStorage.getItem("muted")&&e.commit("toggleMuted",!0),localStorage.getItem("static")&&e.commit("toggleStatic",!0),localStorage.getItem("imageOptIn")&&e.commit("toggleImageOptIn",!0),localStorage.getItem("zoom")&&e.commit("setZoom",parseFloat(localStorage.getItem("zoom"))),localStorage.getItem("isGrimoire")&&(e.commit("toggleGrimoire",!1),t(!1)),void 0!==localStorage.roles&&(e.commit("setCustomRoles",JSON.parse(localStorage.roles)),e.commit("setEdition",{id:"custom"})),void 0!==localStorage.edition&&e.commit("setEdition",JSON.parse(localStorage.edition)),void 0!==localStorage.bluffs&&JSON.parse(localStorage.bluffs).forEach((t,s)=>{e.commit("players/setBluff",{index:s,role:e.state.roles.get(t)||{}})}),void 0!==localStorage.fabled&&e.commit("players/setFabled",{fabled:JSON.parse(localStorage.fabled).map(t=>e.state.fabled.get(t.id)||t)}),localStorage.players&&e.commit("players/set",JSON.parse(localStorage.players).map(t=>({...t,role:e.state.roles.get(t.role)||e.getters.rolesJSONbyId.get(t.role)||{}}))),localStorage.getItem("playerId")&&e.commit("session/setPlayerId",localStorage.getItem("playerId")),localStorage.getItem("session")&&!window.location.hash.substr(1)){const[t,s]=JSON.parse(localStorage.getItem("session"));e.commit("session/setSpectator",t),e.commit("session/setSessionId",s)}e.subscribe(({type:e,payload:s},i)=>{switch(e){case"toggleGrimoire":i.grimoire.isPublic?localStorage.removeItem("isGrimoire"):localStorage.setItem("isGrimoire",1),t(i.grimoire.isPublic);break;case"setBackground":s?localStorage.setItem("background",s):localStorage.removeItem("background");break;case"toggleMuted":i.grimoire.isMuted?localStorage.setItem("muted",1):localStorage.removeItem("muted");break;case"toggleStatic":i.grimoire.isStatic?localStorage.setItem("static",1):localStorage.removeItem("static");break;case"toggleImageOptIn":i.grimoire.isImageOptIn?localStorage.setItem("imageOptIn",1):localStorage.removeItem("imageOptIn");break;case"setZoom":0!==s?localStorage.setItem("zoom",s):localStorage.removeItem("zoom");break;case"setEdition":localStorage.setItem("edition",JSON.stringify(s)),i.edition.isOfficial&&localStorage.removeItem("roles");break;case"setCustomRoles":s.length?localStorage.setItem("roles",JSON.stringify(s)):localStorage.removeItem("roles");break;case"players/setBluff":localStorage.setItem("bluffs",JSON.stringify(i.players.bluffs.map(({id:e})=>e)));break;case"players/setFabled":localStorage.setItem("fabled",JSON.stringify(i.players.fabled.map(e=>e.isCustom?e:{id:e.id})));break;case"players/add":case"players/update":case"players/remove":case"players/clear":case"players/set":case"players/swap":case"players/move":i.players.players.length?localStorage.setItem("players",JSON.stringify(i.players.players.map(e=>({...e,role:e.role.id||{}})))):localStorage.removeItem("players");break;case"session/setSessionId":s?localStorage.setItem("session",JSON.stringify([i.session.isSpectator,s])):localStorage.removeItem("session");break;case"session/setPlayerId":s?localStorage.setItem("playerId",s):localStorage.removeItem("playerId");break}})}},e1bc:function(e,t,s){"use strict";s("535c")},e5ee:function(e,t,s){},e64a:function(e,t,s){e.exports=s.p+"img/seneschal.75b5efbe.svg"},e898:function(e,t,s){e.exports=s.p+"img/bmr-outsider.971a3d5d.png"},e988:function(e,t,s){e.exports=s.p+"img/bmr-townsfolk.9bf859b4.png"},eb38:function(e,t,s){e.exports=s.p+"img/plus.917b30d5.svg"},ed00:function(e,t,s){e.exports=s.p+"img/snv-townsfolk.83cf9a72.png"},f0be:function(e,t,s){"use strict";s("83ea")},f1fc:function(e,t,s){e.exports=s.p+"img/butler.9c09853f.svg"},f22b:function(e,t,s){"use strict";s("2776")},f32e:function(e,t,s){},f347:function(e,t,s){e.exports=s.p+"img/snv-demon.2fe55248.png"},f6a8:function(e,t,s){e.exports=s.p+"media/countdown.1462f20c.mp3"},f7a3:function(e,t,s){e.exports=s.p+"img/tb-townsfolk.d9cbf2e9.png"},f85e:function(e,t,s){e.exports=s.p+"img/prince.80ce1934.svg"},faa9:function(e,t,s){e.exports=s.p+"img/bureaucrat.6f2a3a4f.svg"},fc07:function(e,t,s){e.exports=s.p+"img/marshal.00038fa9.svg"},fc54:function(e,t,s){"use strict";s("9aaf")}});
//# sourceMappingURL=app.7c9f547e.js.map